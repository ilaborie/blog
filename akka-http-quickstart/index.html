<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/blog/component---src-layouts-index-js-ab448737d2670585c2fb.js" as="script"/><link rel="preload" href="/blog/component---src-templates-blog-post-js-ca71989682cd54639ff0.js" as="script"/><link rel="preload" href="/blog/path---akka-http-quickstart-2c6c4f77196227d1f95d.js" as="script"/><link rel="preload" href="/blog/app-2e4ec5db5d74a8606c96.js" as="script"/><link rel="preload" href="/blog/commons-2174e0bf62fcadcdb7a6.js" as="script"/><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml"/><title data-react-helmet="true">Akka HTTP Quickstart | Akka, Concurrency, etc.</title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1em;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:0em;}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:1em;line-height:1.75rem;background-color:#fdf6e3;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}</style><link href="//fonts.googleapis.com/css?family=Montserrat:700|Merriweather:400,400i,700,700i,900,900i" rel="stylesheet" type="text/css"/><style id="gatsby-inlined-css">code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#073642}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.gatsby-highlight-code-line{background-color:#feb;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:.75em;border-left:.25em solid #f99}code{line-height:1rem}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/blog/static/montserrat-latin-100.50d27986.woff2) format("woff2"),url(/blog/static/montserrat-latin-100.5e334eff.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/blog/static/montserrat-latin-100italic.8c070533.woff2) format("woff2"),url(/blog/static/montserrat-latin-100italic.03e19243.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/blog/static/montserrat-latin-200.4343d3d9.woff2) format("woff2"),url(/blog/static/montserrat-latin-200.f2022ecd.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/blog/static/montserrat-latin-200italic.116c4c4b.woff2) format("woff2"),url(/blog/static/montserrat-latin-200italic.89614a60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/blog/static/montserrat-latin-300.d2ad295b.woff2) format("woff2"),url(/blog/static/montserrat-latin-300.3a371ee0.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/blog/static/montserrat-latin-300italic.f6b6bf24.woff2) format("woff2"),url(/blog/static/montserrat-latin-300italic.16521668.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/blog/static/montserrat-latin-400.240a8444.woff2) format("woff2"),url(/blog/static/montserrat-latin-400.b20cc131.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/blog/static/montserrat-latin-400italic.86172bb8.woff2) format("woff2"),url(/blog/static/montserrat-latin-400italic.9405e787.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/blog/static/montserrat-latin-500.fb8d6b71.woff2) format("woff2"),url(/blog/static/montserrat-latin-500.50825d47.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/blog/static/montserrat-latin-500italic.c0a555a4.woff2) format("woff2"),url(/blog/static/montserrat-latin-500italic.635de59c.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/blog/static/montserrat-latin-600.d5615136.woff2) format("woff2"),url(/blog/static/montserrat-latin-600.f300da4f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/blog/static/montserrat-latin-600italic.10f29d13.woff2) format("woff2"),url(/blog/static/montserrat-latin-600italic.2bc37d86.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/blog/static/montserrat-latin-700.7d77e1f0.woff2) format("woff2"),url(/blog/static/montserrat-latin-700.81826529.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/blog/static/montserrat-latin-700italic.1dd2b53f.woff2) format("woff2"),url(/blog/static/montserrat-latin-700italic.c162d257.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/blog/static/montserrat-latin-800.d4e7bf86.woff2) format("woff2"),url(/blog/static/montserrat-latin-800.895aadbf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/blog/static/montserrat-latin-800italic.fc0cbe44.woff2) format("woff2"),url(/blog/static/montserrat-latin-800italic.b3362875.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/blog/static/montserrat-latin-900.c8bdd772.woff2) format("woff2"),url(/blog/static/montserrat-latin-900.1b99ef78.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/blog/static/montserrat-latin-900italic.cb72c1f9.woff2) format("woff2"),url(/blog/static/montserrat-latin-900italic.b78bb9f8.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/blog/static/merriweather-latin-300.f015f1e9.woff2) format("woff2"),url(/blog/static/merriweather-latin-300.92dfe81b.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/blog/static/merriweather-latin-300italic.7fd86b32.woff2) format("woff2"),url(/blog/static/merriweather-latin-300italic.878b76f5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/blog/static/merriweather-latin-400.12dbf4c0.woff2) format("woff2"),url(/blog/static/merriweather-latin-400.1fffad22.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/blog/static/merriweather-latin-400italic.1e0d3e81.woff2) format("woff2"),url(/blog/static/merriweather-latin-400italic.de18d4c4.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/blog/static/merriweather-latin-700.dc8fec81.woff2) format("woff2"),url(/blog/static/merriweather-latin-700.d7d2ed8e.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/blog/static/merriweather-latin-700italic.b7b7e5da.woff2) format("woff2"),url(/blog/static/merriweather-latin-700italic.6210a5fc.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/blog/static/merriweather-latin-900.43f870d5.woff2) format("woff2"),url(/blog/static/merriweather-latin-900.8f3806df.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/blog/static/merriweather-latin-900italic.168c1ab2.woff2) format("woff2"),url(/blog/static/merriweather-latin-900italic.ae7778f0.woff) format("woff")}</style></head><body><div id="___gatsby"><div style="max-width:42rem;margin-left:auto;margin-right:auto;padding:2.625rem 1.3125rem;" data-reactroot="" data-reactid="1" data-react-checksum="-1713837799"><h3 style="font-family:Montserrat, sans-serif;margin-top:0;margin-bottom:-1.75rem;" data-reactid="2"><a style="box-shadow:none;text-decoration:none;color:inherit;" href="/blog/" data-reactid="3">Akka, Concurrency, etc.</a></h3><div data-reactid="4"><!-- react-empty: 5 --><h1 data-reactid="6">Akka HTTP Quickstart</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem;margin-top:-1.75rem;" data-reactid="7">July 15, 2018</p><div data-reactid="8"><h2>Overview</h2>
<p>In this article, I am going to show how to:</p>
<ul>
<li>Run an Akka HTTP server,</li>
<li>Convert to JSON from Scala case classes,</li>
<li>Use Routing DSL.</li>
</ul>
<p>I will set up a simple HTTP server step by step, which in the end works as follows. As you see below, we get different JSON returned dependent on the path.</p>
<img src="/blog/high-level-api-792c91bb20b6c2f1c281c0280dff73af.gif" />
<p>I will go through the steps in a way you can <strong>quickly understand</strong> the outcome from running the source code, and how it works, <strong>WITHOUT downloading and running the source code yourself.</strong></p>
<p>However, for those who want to go much deeper, the full code is available here, with instruction to run the examples.</p>
<p><a href="https://github.com/richardimaoka/resources/tree/master/akka-http-quickstart">Jump to the Git repository with an intruction to run the code</a></p>
<h2>Setting up a minimal application</h2>
<p>In this section, we set up a pretty simple “Hello World” HTTP server. In the end, an Akka HTTP server can be started like below:</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>Http
Http<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bindAndHandle<span class="token punctuation">(</span>routes<span class="token punctuation">,</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span></code></pre>
      </div>
<p><img src="/blog/hello-world-54af7de2c758beb35a0e588cb6205572.gif" alt="hello-world"></p>
<p>So, the <code class="language-text">bindAndHandle</code> method is the method to fire up everything and start the HTTP server. Let’s see what is required to run this <code class="language-text">bindAndHandle</code> method.</p>
<p>Firstly, we should update <a href="https://www.scala-sbt.org/1.x/docs/Library-Dependencies.html"><code class="language-text">libraryDependencies</code></a> in <a href="https://github.com/richardimaoka/resources/blob/master/akka-http-quickstart/build.sbt">build.sbt</a></p>
<div class="gatsby-highlight">
      <pre class="language-text"><code class="language-text">libraryDependencies ++= Seq(
  &quot;com.typesafe.akka&quot; %% &quot;akka-http&quot;   % &quot;10.1.3&quot;,
  &quot;com.typesafe.akka&quot; %% &quot;akka-stream&quot; % &quot;2.5.12&quot;,
)</code></pre>
      </div>
<p>and add a <a href="https://www.scala-lang.org/documentation/your-first-lines-of-scala.html">typical main <code class="language-text">object</code></a>, as well as its main method.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">object</span> MainHelloWorld <span class="token punctuation">{</span>
  <span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// ... application code goes here</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>Inside the main method, we should start adding necessary building blocks to run the Akka HTTP server.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>actor<span class="token punctuation">.</span>ActorSystem
<span class="token keyword">import</span> akka<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>ActorMaterializer

<span class="token comment">// remember to make them implicit!!</span>
<span class="token keyword">implicit</span> <span class="token keyword">val</span> system <span class="token operator">=</span> ActorSystem<span class="token punctuation">(</span><span class="token string">"Main"</span><span class="token punctuation">)</span>       <span class="token comment">// for Akka Actor</span>
<span class="token keyword">implicit</span> <span class="token keyword">val</span> materializer <span class="token operator">=</span> ActorMaterializer<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// for Akka Stream</span></code></pre>
      </div>
<p>As a preparation, we instantiate <code class="language-text">ActorSystem</code> and <code class="language-text">ActorMaterializer</code>. For people who are not familiar with <code class="language-text">ActorSystem</code> and <code class="language-text">ActorMaterializer</code>, you can think of them as the underlying infrastructure for running Akka HTTP.</p>
<p>Usually there is only one instance for each of them in an entire application. In this context, an “entire application” means an OS (e.g. Linux or Windows) process, or a JVM process.  Also we need to remember making <code class="language-text">ActorSystem</code> and <code class="language-text">ActorMaterializer</code> <strong>implicit</strong>, as other methods take implicit parameters of these types.</p>
<hr>
<p><strong>NOTE:</strong> The below roughly illustrates the Akka technology stack cosisting of an Akka HTTP application.</p>
<p align="center">
  <img src="/blog/akka-layers-4cee9958d09be096686ab2ca6cff3612.svg" alt="akka-layers" width="300px"/>
</p>
<ul>
<li>Akka HTTP is on top of the other two layers</li>
<li>Akka Stream (<code class="language-text">ActorMaterializer</code>) handles internal processing of Akka HTTP</li>
<li>Akka Actor (<code class="language-text">ActorSystem</code>) is the base for running Akka Stream</li>
</ul>
<p>In my upcoming articles, we will see how these layers work with each other, and see why and how Akka HTTP is designed as a <a href="https://doc.akka.io/docs/akka-http/current/implications-of-streaming-http-entity.html">”<strong>streaming-first</strong>” HTTP server</a>.</p>
<hr>
<p>The next thing to introduce is <code class="language-text">Route</code>. <code class="language-text">Route</code> in Akka HTTP defines the endpoint structure (or RESTful resource structure, we might say) of the HTTP server with <a href="https://doc.akka.io/docs/akka-http/current/routing-dsl/index.html">Route DSL</a>. Again, we only touch the surface of it in this article, and go deeper in later articles.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token comment">// importing akka...Directives._ makes `get` and `complete` avaialable in scope</span>
<span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>server<span class="token punctuation">.</span>Directives<span class="token punctuation">.</span>_ 
<span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>server<span class="token punctuation">.</span>Route

<span class="token keyword">lazy</span> <span class="token keyword">val</span> routes<span class="token operator">:</span> Route <span class="token operator">=</span> get <span class="token punctuation">{</span> <span class="token comment">// `get` for HTTP GET method</span>
  complete<span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p><code class="language-text">routes</code> in the above code returns <code class="language-text">&quot;Hello World&quot;</code> for HTTP GET methods to any endpoint in the HTTP server. The <code class="language-text">complete</code> method is what is typically used in Akka HTTP when we want to return an HTTP response to the client.</p>
<p>Finally we can add the following code to bring up the HTTP server, like we saw at the begining of this section.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>Http
Http<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bindAndHandle<span class="token punctuation">(</span>routes<span class="token punctuation">,</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span></code></pre>
      </div>
<p>Then run the server.</p>
<div class="gatsby-highlight">
      <pre class="language-text"><code class="language-text">&gt; sbt
&gt; runMain com.example.MainHelloWorld

[info] Running com.example.Main
Server online at http://localhost:8080/</code></pre>
      </div>
<p>And like we saw earlier in this section …</p>
<p><img src="/blog/hello-world-54af7de2c758beb35a0e588cb6205572.gif" alt="hello-world"></p>
<p>Boom! We said hello to the world!</p>
<h2>High-level Routing DSL to construct HTTP endpoint structure (RESTful resource structure)</h2>
<p>We will go a little deeper in how Route DSL works. It is still at a surface level of it, but hopefully this gives you a better idea about how to construct the endpoint structure with the DSL.</p>
<p>Assuming we want to have the following endpoint structure,</p>
<div class="gatsby-highlight">
      <pre class="language-text"><code class="language-text">GET /users/person1
GET /users/person2
GET /users/person3</code></pre>
      </div>
<p>we can construct the route as follows:</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token comment">// importing akka...Directives._ makes `get`, `complete`, `path` avaialable</span>
<span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>server<span class="token punctuation">.</span>Directives<span class="token punctuation">.</span>_ 
<span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>server<span class="token punctuation">.</span>Route

<span class="token keyword">lazy</span> <span class="token keyword">val</span> routes<span class="token operator">:</span> Route <span class="token operator">=</span> 
<span class="gatsby-highlight-code-line">  pathPrefix<span class="token punctuation">(</span><span class="token string">"users"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    path<span class="token punctuation">(</span><span class="token string">"person1"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span>      get <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">        complete<span class="token punctuation">(</span>"Joh Don<span class="token punctuation">)</span>
</span>      <span class="token punctuation">}</span>
<span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span> <span class="token operator">~</span> <span class="token comment">//don't forget `~`</span>
</span>    path<span class="token punctuation">(</span><span class="token string">"person2"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      get <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">        complete<span class="token punctuation">(</span><span class="token string">"Justin Bieber"</span><span class="token punctuation">)</span>
</span>      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token operator">~</span>
    path<span class="token punctuation">(</span><span class="token string">"person3"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      get <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">        complete<span class="token punctuation">(</span><span class="token string">"Peyton List"</span><span class="token punctuation">)</span>
</span>      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> 
  <span class="token punctuation">}</span></code></pre>
      </div>
<p>Now, we get three different responses dependent on the path.</p>
<p><img src="/blog/high-level-api-step1-3bd357ca49cce9b94a3269704f244dd3.gif" alt="high-level-step1"></p>
<p>Since we set up these three endpoints for the HTTP <strong>GET</strong> method only,
doing (e.g.) POST will give us an error. </p>
<div class="gatsby-highlight">
      <pre class="language-text"><code class="language-text">$ curl -X POST -d &#39;{&quot;key&quot;: &quot;value&quot;}&#39; http://localhost:8080/users/person1

// HTTP/1.1 405 Method Not Allowed
HTTP method not allowed, supported methods: GET</code></pre>
      </div>
<p>Also, accessing a path which is not defined in the route will also result in an error.</p>
<div class="gatsby-highlight">
      <pre class="language-text"><code class="language-text">$ curl http://localhost:8080/users/nosuchperson

// HTTP/1.1 404 Not Found
The requested resource could not be found.</code></pre>
      </div>
<p>In a separate article, we go over details about the Route DSL, and introduce how to:</p>
<ul>
<li>support POST, PATCH, DELETE and even custom HTTP methods</li>
<li>authenticate the user</li>
<li>do more complicated stuff like CORS with plugins</li>
<li>and lot more!</li>
</ul>
<h2>JSON to/from Scala case class conversion</h2>
<p>Just returning plain <code class="language-text">String</code> values to user is nothing interesting.
Akka HTTP is well suited to API servers, and today’s API servers most commonly interchanges JSON with clients.</p>
<p><img src="/blog/high-level-api-792c91bb20b6c2f1c281c0280dff73af.gif" alt="high-level"></p>
<p>In Akka HTTP, JSON support comes in a form of plugins, and <a href="https://github.com/spray/spray-json">spray-json</a>
is one of the easiest JSON plugins to use, and also introduced in the official <a href="https://doc.akka.io/docs/akka-http/current/common/json-support.html">doc</a>.</p>
<h3>Scala case class to JSON - HTTP response</h3>
<p>In this article, we cover only one path - Scala case class to JSON conversion. The other way around, from JSON to Scala case classes should be covered in a separate article, to limit the length of this quick-start article.</p>
<p>To use spray-json, we need the following in <code class="language-text">libraryDependencies</code>.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala">libraryDependencies <span class="token operator">++</span><span class="token operator">=</span> Seq<span class="token punctuation">(</span>
  <span class="token string">"com.typesafe.akka"</span> <span class="token operator">%</span><span class="token operator">%</span> <span class="token string">"akka-http"</span>   <span class="token operator">%</span> <span class="token string">"10.1.3"</span><span class="token punctuation">,</span>
  <span class="token string">"com.typesafe.akka"</span> <span class="token operator">%</span><span class="token operator">%</span> <span class="token string">"akka-stream"</span> <span class="token operator">%</span> <span class="token string">"2.5.12"</span><span class="token punctuation">,</span>
<span class="gatsby-highlight-code-line">  <span class="token string">"com.typesafe.akka"</span> <span class="token operator">%</span><span class="token operator">%</span> <span class="token string">"akka-http-spray-json"</span> <span class="token operator">%</span> <span class="token string">"10.1.3"</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">  <span class="token string">"io.spray"</span> <span class="token operator">%</span><span class="token operator">%</span>  <span class="token string">"spray-json"</span> <span class="token operator">%</span> <span class="token string">"1.3.4"</span>
</span><span class="token punctuation">)</span></code></pre>
      </div>
<p>And instead of returning a plain <code class="language-text">String</code>,</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala">get <span class="token punctuation">{</span>
  complete<span class="token punctuation">(</span><span class="token string">"Joh Don"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>we can pass in a Scala case class to the <code class="language-text">complete</code> method,</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala">get <span class="token punctuation">{</span>
  complete<span class="token punctuation">(</span>
    <span class="token comment">// `User` is a Scala case class</span>
<span class="gatsby-highlight-code-line">    User<span class="token punctuation">(</span>
</span><span class="gatsby-highlight-code-line">      name <span class="token operator">=</span> <span class="token string">"Joh Don"</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">      age <span class="token operator">=</span> <span class="token number">35</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span>
</span>  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>and it’s magically turned into JSON within the HTTP response body.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token comment">// &lt;--------------- converted &lt;----------------</span>
<span class="token comment">// JSON                 | //Scala case class</span>
<span class="token punctuation">{</span>                       <span class="token operator">|</span>  User<span class="token punctuation">(</span>
  <span class="token string">"name"</span><span class="token operator">:</span> <span class="token string">"Joh Don"</span><span class="token punctuation">,</span>    <span class="token operator">|</span>    name <span class="token operator">=</span> <span class="token string">"Joh Don"</span><span class="token punctuation">,</span>
  <span class="token string">"age"</span><span class="token operator">:</span>  <span class="token number">35</span>            <span class="token operator">|</span>    age <span class="token operator">=</span> <span class="token number">35</span> 
<span class="token punctuation">}</span>                       <span class="token operator">|</span>  <span class="token punctuation">)</span></code></pre>
      </div>
<p>So, what’s necessary to make this magic happen? We need some type class-based
implicit resolution done by spray-json in conjunction with Akka HTTP.</p>
<hr>
<p><strong>Note</strong>: Understanding what’s happening <strong>inside</strong> this <a href="https://doc.akka.io/docs/akka-http/current/common/marshalling.html">JSON to/from Scala case class conversion</a> is really, really a difficult thing. I personally gave it up more than five times in the past, by going through the official documentation, read the source code and ended up just wasting time.</p>
<p>However, to make the JSON to/from Scala case class conversion happen, fortunately Akka HTTP is desined so that we <strong>don’t need to</strong> understand what’s happening inside. We just need to know what to <code class="language-text">import</code> and what kind of <code class="language-text">implicit</code> to define.</p>
<p>If you are still interested in the internal workings, I’ll write other articles to help you. I hope my articles I will write work as supplemental materials to the official doc if you felt that is not very easy to understand, like I did before.</p>
<hr>
<p>From here we see how to make the conversion happen. After updating <code class="language-text">libraryDependencies</code> in <code class="language-text">build.sbt</code>, we should introduce the following case class.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">case</span> <span class="token keyword">class</span> User<span class="token punctuation">(</span>
  name<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span>  <span class="token builtin">Int</span>
<span class="token punctuation">)</span></code></pre>
      </div>
<p>This case class models the JSON in the HTTP response body, returned to the client. Then we add <code class="language-text">implicit</code> <code class="language-text">RootJsonFormat[User]</code> which is typically placed in the companion object of the modeling case class.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token comment">//importing DefaultJsonProtocol._ makes `jsonFormat2` available</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">import</span> spray<span class="token punctuation">.</span>json<span class="token punctuation">.</span>DefaultJsonProtocol<span class="token punctuation">.</span>_ 
</span><span class="gatsby-highlight-code-line"><span class="token keyword">import</span> spray<span class="token punctuation">.</span>json<span class="token punctuation">.</span>RootJsonFormat
</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> User<span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span>

<span class="gatsby-highlight-code-line"><span class="token keyword">object</span> User <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">  <span class="token comment">// this will fit in the implicit resolution,</span>
</span><span class="gatsby-highlight-code-line">  <span class="token comment">// enabling JSON/case class conversion</span>
</span><span class="gatsby-highlight-code-line">  <span class="token keyword">implicit</span> <span class="token keyword">val</span> userJsonFormat<span class="token operator">:</span> RootJsonFormat<span class="token punctuation">[</span>User<span class="token punctuation">]</span> <span class="token operator">=</span>
</span><span class="gatsby-highlight-code-line">    jsonFormat2<span class="token punctuation">(</span>User<span class="token punctuation">.</span>apply<span class="token punctuation">)</span>
</span><span class="gatsby-highlight-code-line"><span class="token punctuation">}</span>
</span></code></pre>
      </div>
<p><code class="language-text">jsonFormat2</code> is a convenient method which takes the <code class="language-text">apply</code> method of a two-value case class, and return <code class="language-text">RootJsonFormat</code>. By using <code class="language-text">jsonFormat2</code>, we don’t need to implement field-by-field assignment manually like below.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token comment">// if we do not use a plugin like spray-json</span>
<span class="token keyword">val</span> json <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
User<span class="token punctuation">(</span>
  <span class="token comment">// this field-by-field translation</span>
  <span class="token comment">// is NOT needed if we use `jsonFormat2`</span>
  name <span class="token operator">=</span> json<span class="token punctuation">.</span>getField<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  age <span class="token operator">=</span> json<span class="token punctuation">.</span>getField<span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span></code></pre>
      </div>
<p>Then on the <code class="language-text">Route</code> side of the code, we need the following import and pass in a <code class="language-text">User</code> instance to the <code class="language-text">complete</code> method.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="gatsby-highlight-code-line"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>marshallers<span class="token punctuation">.</span>sprayjson<span class="token punctuation">.</span>SprayJsonSupport<span class="token punctuation">.</span>_
</span><span class="gatsby-highlight-code-line"><span class="token comment">//this bring in implicit RootJsonFormat[User]</span>
</span><span class="gatsby-highlight-code-line"><span class="token keyword">import</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User
</span>
get <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  complete<span class="token punctuation">(</span>User<span class="token punctuation">(</span><span class="token string">"Joh Don"</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="token punctuation">}</span></code></pre>
      </div>
<p>Importing these two will bring all the necessary pieces of implicit resolution, which works like putting pieces into the puzzle, and <code class="language-text">User</code> can now be converted to JSON.</p>
<p><img src="/blog/implicit-resolution-ed2b3779a41e22f8071c2c24413aee7d.jpg" alt="implicit resolution"></p>
<p>We should do the same thing to the three paths we constructed before.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>marshallers<span class="token punctuation">.</span>sprayjson<span class="token punctuation">.</span>SprayJsonSupport<span class="token punctuation">.</span>_
<span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>server<span class="token punctuation">.</span>Directives<span class="token punctuation">.</span>_ 
<span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>server<span class="token punctuation">.</span>Route
<span class="token keyword">import</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User

<span class="token keyword">lazy</span> <span class="token keyword">val</span> routes<span class="token operator">:</span> Route <span class="token operator">=</span> 
  path<span class="token punctuation">(</span><span class="token string">"users/"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">(</span><span class="token string">"person1"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      get <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">        complete<span class="token punctuation">(</span>User<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Joh Don"</span><span class="token punctuation">,</span> age <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span>      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token operator">~</span>
    path<span class="token punctuation">(</span><span class="token string">"person2"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      get <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">        complete<span class="token punctuation">(</span>User<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Justin Bieber"</span><span class="token punctuation">,</span> age <span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span>      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token operator">~</span>
    path<span class="token punctuation">(</span><span class="token string">"person3"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      get <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">        complete<span class="token punctuation">(</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Peyton List"</span><span class="token punctuation">,</span> age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span>      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span></code></pre>
      </div>
<p>And we can see this in action as follows.</p>
<div class="gatsby-highlight">
      <pre class="language-text"><code class="language-text">&gt; sbt
&gt; runMain com.example.main.MainHighLevelAPI</code></pre>
      </div>
<p><img src="/blog/high-level-api-complete-55cf956ed73ee75d743b703e7792cdb5.gif" alt="high-level-api-complete"></p>
<h3>Nested case class support by spray-json</h3>
<p>Another convenient feature of spray-json is (although other JSON plugins also have similar fetures) that it supports conversion of nested Scala case classes. Suppose we have the following two case classes defined.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">import</span> spray<span class="token punctuation">.</span>json<span class="token punctuation">.</span>DefaultJsonProtocol<span class="token punctuation">.</span>jsonFormat4
<span class="token keyword">import</span> spray<span class="token punctuation">.</span>json<span class="token punctuation">.</span>RootJsonFormat

<span class="token keyword">case</span> <span class="token keyword">class</span> Address<span class="token punctuation">(</span>
<span class="gatsby-highlight-code-line">  zip<span class="token operator">:</span>    <span class="token builtin">Int</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">  street<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">  city<span class="token operator">:</span>   <span class="token builtin">String</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">  state<span class="token operator">:</span>  <span class="token builtin">String</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line"><span class="token punctuation">)</span>
</span><span class="gatsby-highlight-code-line">
</span><span class="token keyword">object</span> Address <span class="token punctuation">{</span>
  <span class="token comment">// this will fit in the implicit resolution,</span>
  <span class="token comment">// enabling JSON/case class conversion</span>
  <span class="token keyword">implicit</span> <span class="token keyword">val</span> addressJsonFormat<span class="token operator">:</span> RootJsonFormat<span class="token punctuation">[</span>Address<span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="gatsby-highlight-code-line">    jsonFormat4<span class="token punctuation">(</span>Address<span class="token punctuation">.</span>apply<span class="token punctuation">)</span>
</span><span class="token punctuation">}</span></code></pre>
      </div>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">import</span> spray<span class="token punctuation">.</span>json<span class="token punctuation">.</span>DefaultJsonProtocol<span class="token punctuation">.</span>jsonFormat3
<span class="token keyword">import</span> spray<span class="token punctuation">.</span>json<span class="token punctuation">.</span>RootJsonFormat
<span class="gatsby-highlight-code-line"><span class="token keyword">import</span> Address<span class="token punctuation">.</span>_ <span class="token comment">// implicit val addressJsonFormat</span>
</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> EnrichedUser<span class="token punctuation">(</span>
  name<span class="token operator">:</span>    <span class="token builtin">String</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span>     <span class="token builtin">Int</span><span class="token punctuation">,</span>
  address<span class="token operator">:</span> Address <span class="token comment">//nested case class</span>
<span class="token punctuation">)</span>

<span class="token keyword">object</span> EnrichedUser <span class="token punctuation">{</span>
  <span class="token comment">// this will fit in the implicit resolution,</span>
  <span class="token comment">// enabling JSON/case class conversion</span>
  <span class="token keyword">implicit</span> <span class="token keyword">val</span> enrichedUserJsonFormat<span class="token operator">:</span> RootJsonFormat<span class="token punctuation">[</span>EnrichedUser<span class="token punctuation">]</span> <span class="token operator">=</span>
    jsonFormat3<span class="token punctuation">(</span>User<span class="token punctuation">.</span>apply<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>And if we <code class="language-text">complete</code> the route like below, </p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>marshallers<span class="token punctuation">.</span>sprayjson<span class="token punctuation">.</span>SprayJsonSupport<span class="token punctuation">.</span>_
<span class="token keyword">import</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User

get <span class="token punctuation">{</span>
  complete<span class="token punctuation">(</span>
<span class="gatsby-highlight-code-line">    EnrichedUser<span class="token punctuation">(</span>
</span><span class="gatsby-highlight-code-line">      <span class="token string">"Richard Imaoka"</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">      <span class="token number">150</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">      Address<span class="token punctuation">(</span>
</span><span class="gatsby-highlight-code-line">        zip <span class="token operator">=</span> <span class="token number">1112222</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">        street <span class="token operator">=</span> <span class="token string">"5-6-7 XYZ-street"</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">        city <span class="token operator">=</span> <span class="token string">"New York"</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">        state <span class="token operator">=</span> <span class="token string">"New York"</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">      <span class="token punctuation">)</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span>
</span>  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>we will get the following JSON.</p>
<div class="gatsby-highlight">
      <pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Richard Imaoka"</span><span class="token punctuation">,</span>
  <span class="token property">"age"</span><span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span>
<span class="gatsby-highlight-code-line">  <span class="token property">"address"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token property">"zip"</span><span class="token operator">:</span> <span class="token number">1112222</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">    <span class="token property">"street"</span> <span class="token operator">:</span> <span class="token string">"5-6-7 XYZ-street"</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">    <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"New York"</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">    <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"New York"</span>     
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span><span class="token punctuation">}</span></code></pre>
      </div>
<p>This helps us model the JSON data with reusable and <strong>composable</strong> Scala case classes, and will be useful when we are constructing a large JSON response.</p>
<h2>Low-level API, needs understanding of HttpRequest and HttpResponse</h2>
<p>Most of the cases we will be implementing our endpoint structure using the Route DSL.
However, for certain cases we would need more fine-grained, lower-level control on how to respond to a given HTTP request. With the low-level API, instead of Route DSL, we implement a request handler in</p>
<ul>
<li><code class="language-text">HttpRequest =&gt; HttpResponse</code>, or </li>
<li><code class="language-text">HttpRequest =&gt; Future[HttpResponse]</code> </li>
</ul>
<p>using pattern matches like below.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token punctuation">{</span>HttpRequest<span class="token punctuation">,</span> HttpResponse<span class="token punctuation">}</span>

<span class="token keyword">val</span> requestHandler<span class="token operator">:</span> HttpRequest <span class="token keyword">=></span> HttpResponse <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> HttpRequest<span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token keyword">=></span> HttpResponse<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>    </code></pre>
      </div>
<p>That’s roughly how the low level API looks differently from the high level one, then we get into a bit of more detail about this below. Like the case of high level API, we need to instantiate <code class="language-text">ActorSystem</code> and <code class="language-text">ActorMaterializer</code>.</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>actor<span class="token punctuation">.</span>ActorSystem
<span class="token keyword">import</span> akka<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>ActorMaterializer

<span class="token keyword">implicit</span> <span class="token keyword">val</span> system<span class="token operator">:</span> ActorSystem <span class="token operator">=</span> ActorSystem<span class="token punctuation">(</span><span class="token string">"Main"</span><span class="token punctuation">)</span>
<span class="token keyword">implicit</span> <span class="token keyword">val</span> materializer<span class="token operator">:</span> ActorMaterializer <span class="token operator">=</span> ActorMaterializer<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
      </div>
<p>And the detail of the pattern match is as follows:</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>marshallers<span class="token punctuation">.</span>sprayjson<span class="token punctuation">.</span>SprayJsonSupport<span class="token punctuation">.</span>_
<span class="gatsby-highlight-code-line"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>marshalling<span class="token punctuation">.</span>Marshal
</span><span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>model<span class="token punctuation">.</span>HttpMethods<span class="token punctuation">.</span>GET
<span class="gatsby-highlight-code-line"><span class="token comment">// for HttpRequest, HttpResponse, Uri</span>
</span><span class="gatsby-highlight-code-line"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>model<span class="token punctuation">.</span>_
</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User
<span class="token keyword">import</span> scala<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span><span class="token punctuation">{</span>ExecutionContext<span class="token punctuation">,</span> Future<span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line"><span class="token keyword">implicit</span> <span class="token keyword">val</span> ec<span class="token operator">:</span> ExecutionContext <span class="token operator">=</span> system<span class="token punctuation">.</span>dispatcher
</span>
<span class="token keyword">val</span> requestHandler<span class="token operator">:</span> HttpRequest <span class="token keyword">=></span> Future<span class="token punctuation">[</span>HttpResponse<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">case</span> HttpRequest<span class="token punctuation">(</span>
</span><span class="gatsby-highlight-code-line">    GET<span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">    Uri<span class="token punctuation">.</span>Path<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">    _<span class="token punctuation">,</span> <span class="token comment">// matches any headers</span>
</span><span class="gatsby-highlight-code-line">    _<span class="token punctuation">,</span> <span class="token comment">// matches any HTTP entity (HTTP body)</span>
</span><span class="gatsby-highlight-code-line">    _  <span class="token comment">// matches any HTTP protocol</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">)</span> <span class="token keyword">=></span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">val</span> m <span class="token operator">=</span> Marshal<span class="token punctuation">(</span>User<span class="token punctuation">(</span><span class="token string">"Richard Imaoka"</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="gatsby-highlight-code-line">    m<span class="token punctuation">.</span>to<span class="token punctuation">[</span>HttpResponse<span class="token punctuation">]</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span><span class="token punctuation">}</span></code></pre>
      </div>
<p>Then we can run the HTTP server like before,</p>
<div class="gatsby-highlight">
      <pre class="language-scala"><code class="language-scala"><span class="token keyword">import</span> akka<span class="token punctuation">.</span>http<span class="token punctuation">.</span>scaladsl<span class="token punctuation">.</span>Http

Http<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bindAndHandleAsync<span class="token punctuation">(</span>requestHandler<span class="token punctuation">,</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span></code></pre>
      </div>
<p>and we get this result.</p>
<p><img src="/blog/low-level-api-ab0f421093d7a334cbaccbe40c4e3b36.png" alt="low-level-api"></p>
<h2>The intention of this article</h2>
<p>The content of this article might have felt boring to you, as there have already been many other articles covered the same stuff, and this is just like intro of introduction. </p>
<p>However, I wrote this with a clear intention - I tried to make this article:</p>
<ul>
<li>Easy to see what happens upon running the code, without actually running it by hand</li>
<li>Illustrate how it feels on writing Akka HTTP code, rather than explaining all the technical details</li>
<li>but still not leaving readers in a gap, awkward jump in the context</li>
<li>Have concise text, not talking endlessly about something readers are not interested</li>
</ul></div><hr style="margin-bottom:1.75rem;" data-reactid="9"/><div style="display:flex;margin-bottom:4.375rem;" data-reactid="10"><img src="/blog/static/profile-pic.200b73a9.jpg" alt="Richard Imaoka" style="margin-right:0.875rem;margin-bottom:0;width:3.5rem;height:3.5rem;" data-reactid="11"/><p data-reactid="12"><!-- react-text: 13 -->Written by <!-- /react-text --><strong data-reactid="14">Richard Imaoka</strong><!-- react-text: 15 -->, a Scala developer . You can find me (richardimaoka) at <!-- /react-text --><a href="https://twitter.com/richardimaoka" data-reactid="16">twitter</a><!-- react-text: 17 -->, and <!-- /react-text --><a href="https://github.com/richardimaoka" data-reactid="18">github</a><!-- react-text: 19 -->.<!-- /react-text --></p></div></div><span style="display:block;clear:both;" data-reactid="20"> </span></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-2e4ec5db5d74a8606c96.js","99219681209289":"component---node-modules-gatsby-plugin-offline-app-shell-js-5c4c5a0f7af9dc69d6d7.js","107818501498521":"component---src-templates-blog-post-js-ca71989682cd54639ff0.js","35783957827783":"component---src-pages-index-js-f3ac62be02813b36160e.js","60335399758886":"path----557518bd178906f8d58a.js","210333531512890":"path---offline-plugin-app-shell-fallback-a0e39f21c11f6a62c5ab.js","90106736999892":"path---persistent-actor-minimal-bde785d751cc4fbf7079.js","160326069391746":"path---serializer-minimal-39942be9fcede28e2b38.js","74705494097707":"path---remote-minimal-setup-9f67c56dafa7e95736ba.js","218392457165648":"path---akka-http-quickstart-2c6c4f77196227d1f95d.js","224718722256965":"path---event-adapter-cassandra-95f49fb0d097c223d523.js","240229599778477":"path---akka-behavior-levels-04992e1cba9364361e39.js","217632986566844":"path---executor-and-execution-context-30e35a3234f9e1ca6776.js","215048048543570":"path---benchmarking-akka-http-cassandra-local-b285dfe4865738da449e.js","235964179464078":"path---dispatcher-behavior-76a0594a10dca3d7e060.js","86659390886147":"path---local-minimal-receiver-247eef626e6c2d4eb270.js","165329427061039":"path---mailbox-and-fork-join-task-f2836659cca62eb9de17.js","205347915900230":"path---hello-world-http-bench-b7953a4dae11e1727b74.js","36029449993048":"path---local-minimal-sender-a922812b411d73516504.js","26725176786023":"path---persistent-actor-minimal-sql-9a0343ea97f5f7e1a009.js","82537549859403":"path---oss-hackathon-1-56629f0e9e59f45a9e98.js","241179671101829":"path---remote-minimal-sender-4b957c22f49d7be897aa.js","221230463047462":"path---swagger-akka-http-72da75c5bbc86a16dcd1.js","107690442534757":"path---remote-minimal-receiver-f36cb7864e9a98e8033b.js","142629428675168":"path---index-3536c3ae9ef44dd2a666.js","114276838955818":"component---src-layouts-index-js-ab448737d2670585c2fb.js"}/*]]>*/</script><script>
            
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-111892799-1', 'auto');
      }
      </script><script>
          window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));
      </script><script>/*<![CDATA[*/["/blog/commons-2174e0bf62fcadcdb7a6.js","/blog/app-2e4ec5db5d74a8606c96.js","/blog/path---akka-http-quickstart-2c6c4f77196227d1f95d.js","/blog/component---src-templates-blog-post-js-ca71989682cd54639ff0.js","/blog/component---src-layouts-index-js-ab448737d2670585c2fb.js"].forEach(function(s){document.write('<script src="'+s+'" defer></'+'script>')})/*]]>*/</script></body></html>