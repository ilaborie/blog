<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Akka, Concurrency, etc.]]></title><description><![CDATA[Memo about Akka, concurrency, and other technical stuff]]></description><link>https://richardimaoka.github.io/blog/</link><generator>RSS for Node</generator><lastBuildDate>Sat, 24 Feb 2018 06:16:45 GMT</lastBuildDate><item><title><![CDATA[Dispatcher behavior]]></title><description><![CDATA[Overview The concept of Akka  Dispatcher  might be unfamiliar to you and it is probably difficult to understand. So I am going to explain…]]></description><link>https://richardimaoka.github.io/blog//dispatcher-behavior/</link><guid isPermaLink="false">https://richardimaoka.github.io/blog//dispatcher-behavior/</guid><pubDate>Mon, 12 Feb 2018 16:31:08 GMT</pubDate><content:encoded>&lt;h2&gt;Overview&lt;/h2&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe src=&quot;https://www.youtube.com/embed/0tDFep0hOSI&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;p&gt;The concept of Akka &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/dispatchers.html?language=scala&quot;&gt;&lt;code&gt;Dispatcher&lt;/code&gt;&lt;/a&gt; might be unfamiliar to you and it is probably difficult to understand. So I am going to explain how Dispatcher works in detail here.&lt;/p&gt;
&lt;h2&gt;Meaning of “dispatch”&lt;/h2&gt;
&lt;p&gt;If you look up the meaning of the word “dispatch” in a dictionary, you would find it is almost same as “send”. In akka, &lt;code&gt;Dispatcher&lt;/code&gt; is, yes, what sends messages, but something more than that.&lt;/p&gt;
&lt;h2&gt;Dispatcher and Actor relationship&lt;/h2&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/dispatcher-config-71bb79f013295f371bbb154394bc0b8e-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdhqxsYn/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAEDIQIRMv/aAAgBAQABBQKShWIneoseT//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABEBH/2gAIAQEABj8C2tin/8QAHBABAAICAwEAAAAAAAAAAAAAAQARMUEhYZGx/9oACAEBAAE/IUnfqKhXkwiDZK+zkrDc/9oADAMBAAIAAwAAABDbD//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/EBJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAQACAgMAAAAAAAAAAAAAAREAITHBQWFx/9oACAEBAAE/EH4oDgzyHeVQ2nJrftmKmkTSYyM0GWaYDZFBa+sAICb6z//Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;dispatcher-config&quot;
        title=&quot;&quot;
        src=&quot;/static/dispatcher-config-71bb79f013295f371bbb154394bc0b8e-f8fb9.jpg&quot;
        srcset=&quot;/static/dispatcher-config-71bb79f013295f371bbb154394bc0b8e-e8976.jpg 148w,
/static/dispatcher-config-71bb79f013295f371bbb154394bc0b8e-63df2.jpg 295w,
/static/dispatcher-config-71bb79f013295f371bbb154394bc0b8e-f8fb9.jpg 590w,
/static/dispatcher-config-71bb79f013295f371bbb154394bc0b8e-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Firstly, &lt;code&gt;Dispatcher&lt;/code&gt; is configured for &lt;code&gt;ActorSystem&lt;/code&gt;, typically in &lt;code&gt;application.conf&lt;/code&gt;. There is at least default one, and you can &lt;a href=&quot;https://doc.akka.io/docs/akka/current/dispatchers.html#dispatchers&quot;&gt;also configure multiple &lt;code&gt;Dispatcher&lt;/code&gt;s&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; system &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ActorSystem&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;exampleSystem&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
system&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dispatchers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;lookup&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;my-dispatcher&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;As a rule of thumb, the &lt;code&gt;Dispatcher&lt;/code&gt; instance for the given name is created when the &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Dispatchers.scala#L79&quot;&gt;&lt;code&gt;lookup&lt;/code&gt; method of &lt;code&gt;ActorSystem&lt;/code&gt;&lt;/a&gt; is called for the first time. You don’t normally call it yourself, but this lookup is done by akka. Another thing is the default &lt;code&gt;Dispatcher&lt;/code&gt; is already created upon &lt;code&gt;ActorSystem&lt;/code&gt; initialization, as it calls &lt;code&gt;lookup&lt;/code&gt; for the default internally.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token comment&quot;&gt;/**
* Returns a dispatcher as specified in configuration. Please note that this
* method _may_ create and return a NEW dispatcher, _every_ call.
*
* Throws ConfigurationException if the specified dispatcher cannot be found in the configuration.
*/&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; lookup&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; MessageDispatcher &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lookupConfigurator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dispatcher&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/dispatcher-actor-7b6a80fb086b1889109bdb71e0f6f72f-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB7Nc0RDF//8QAGRAAAQUAAAAAAAAAAAAAAAAAEAABESEy/9oACAEBAAEFArUBtD//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPwEn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAgMAAAAAAAAAAAAAAAAAARACMWH/2gAIAQEABj8ConHJ/wD/xAAbEAACAgMBAAAAAAAAAAAAAAABERAxACGBsf/aAAgBAQABPyGpLj0ywAqXY80//9oADAMBAAIAAwAAABCPD//EABURAQEAAAAAAAAAAAAAAAAAABAx/9oACAEDAQE/EIP/xAAWEQADAAAAAAAAAAAAAAAAAAABEDH/2gAIAQIBAT8QNX//xAAbEAEAAgIDAAAAAAAAAAAAAAABABFBYRAhgf/aAAgBAQABPxBQdJWBVeG4gKlXZhAoom161z//2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;dispatcher-actor&quot;
        title=&quot;&quot;
        src=&quot;/static/dispatcher-actor-7b6a80fb086b1889109bdb71e0f6f72f-f8fb9.jpg&quot;
        srcset=&quot;/static/dispatcher-actor-7b6a80fb086b1889109bdb71e0f6f72f-e8976.jpg 148w,
/static/dispatcher-actor-7b6a80fb086b1889109bdb71e0f6f72f-63df2.jpg 295w,
/static/dispatcher-actor-7b6a80fb086b1889109bdb71e0f6f72f-f8fb9.jpg 590w,
/static/dispatcher-actor-7b6a80fb086b1889109bdb71e0f6f72f-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;&lt;code&gt;Dispatcher&lt;/code&gt; is NOT part of &lt;code&gt;Actor&lt;/code&gt;. One &lt;code&gt;Dispatcher&lt;/code&gt; can send messages to multiple &lt;code&gt;Actor&lt;/code&gt;s. (NOTE: &lt;code&gt;Dispatcher&lt;/code&gt; doesn’t have routing capabilities. Routing is done by akka &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/routing.html#routing&quot;&gt;&lt;code&gt;Router&lt;/code&gt;&lt;/a&gt;)&lt;/p&gt;
&lt;h2&gt;Dispatcher and ExecutorService&lt;/h2&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/dispatcher-executor-service-35308dce71584aa4d7cdfad5c6d455dd-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHdUwC5Iv8A/8QAGhAAAgIDAAAAAAAAAAAAAAAAAQIAEAMRMf/aAAgBAQABBQIzHs03Fr//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAAREgIv/aAAgBAQAGPwI0or//xAAbEAEAAgIDAAAAAAAAAAAAAAABABARIUFx4f/aAAgBAQABPyFgZYjdjv2jmOVf/9oADAMBAAIAAwAAABDvD//EABYRAAMAAAAAAAAAAAAAAAAAABARIf/aAAgBAwEBPxCsf//EABYRAAMAAAAAAAAAAAAAAAAAABARIf/aAAgBAgEBPxCsf//EABwQAQEAAgIDAAAAAAAAAAAAAAERABAhQVFxsf/aAAgBAQABPxC2E6IzF1gkDo+lohpecIMnj5r/2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;dispatcher-executor-service&quot;
        title=&quot;&quot;
        src=&quot;/static/dispatcher-executor-service-35308dce71584aa4d7cdfad5c6d455dd-f8fb9.jpg&quot;
        srcset=&quot;/static/dispatcher-executor-service-35308dce71584aa4d7cdfad5c6d455dd-e8976.jpg 148w,
/static/dispatcher-executor-service-35308dce71584aa4d7cdfad5c6d455dd-63df2.jpg 295w,
/static/dispatcher-executor-service-35308dce71584aa4d7cdfad5c6d455dd-f8fb9.jpg 590w,
/static/dispatcher-executor-service-35308dce71584aa4d7cdfad5c6d455dd-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;&lt;code&gt;Dispatcher&lt;/code&gt; has &lt;code&gt;ExecutorService&lt;/code&gt;, and &lt;code&gt;ExecutorService&lt;/code&gt; is like a pool of threads where you can execute code (&lt;code&gt;Runnable&lt;/code&gt;) concurrently. See &lt;a href=&quot;../executor-and-execution-context&quot;&gt;Executor/ExecutorService in Java, and ExecutionContext behind Future in Scala&lt;/a&gt; for illustration and more details.&lt;/p&gt;
&lt;p&gt;Here is &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Dispatcher.scala#L47&quot;&gt;&lt;code&gt;executorService&lt;/code&gt; method&lt;/a&gt; of &lt;code&gt;Dispatcher&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; executorService&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ExecutorServiceDelegate &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;The pool of threads from &lt;code&gt;ExecutorService&lt;/code&gt; is what invokes &lt;code&gt;Actor&lt;/code&gt;’s &lt;code&gt;receive&lt;/code&gt; method, which will be explained later in this article.&lt;/p&gt;
&lt;h2&gt;Dispatcher and sender-side behavior&lt;/h2&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/actor-cell-reference-6638f57fa06f7a2f08d0bd841a7eb514-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB20sBAon/xAAZEAACAwEAAAAAAAAAAAAAAAABEQACEiD/2gAIAQEAAQUCRddHhCf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAACAwEAAAAAAAAAAAAAAAAAAREgIjH/2gAIAQEABj8CZpRTh//EAB0QAAECBwAAAAAAAAAAAAAAAAABIRARMUFR0eH/2gAIAQEAAT8hRzdLG9uk0zF6g//aAAwDAQACAAMAAAAQgP8A/8QAFhEBAQEAAAAAAAAAAAAAAAAAACEB/9oACAEDAQE/EMiv/8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQIBAT8QR//EABwQAQACAgMBAAAAAAAAAAAAAAERIQAxEEFhkf/aAAgBAQABPxC6WWZvmsL2RehfxZHUKrfK6VFZWM//2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;actor-cell-reference&quot;
        title=&quot;&quot;
        src=&quot;/static/actor-cell-reference-6638f57fa06f7a2f08d0bd841a7eb514-f8fb9.jpg&quot;
        srcset=&quot;/static/actor-cell-reference-6638f57fa06f7a2f08d0bd841a7eb514-e8976.jpg 148w,
/static/actor-cell-reference-6638f57fa06f7a2f08d0bd841a7eb514-63df2.jpg 295w,
/static/actor-cell-reference-6638f57fa06f7a2f08d0bd841a7eb514-f8fb9.jpg 590w,
/static/actor-cell-reference-6638f57fa06f7a2f08d0bd841a7eb514-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Part of below is reharsing what was already discussed in &lt;a href=&quot;../local-minimal-sender&quot;&gt;Local Actor workflow part 1 - Sender side&lt;/a&gt;, but here more from the &lt;code&gt;Dispatcher&lt;/code&gt; perspective. &lt;/p&gt;
&lt;p&gt;(For remoting, there are several more steps to go through but it is combination of local message-passing and network via Netty, as discussed in &lt;a href=&quot;../remote-minimal-sender&quot;&gt;remoting articles&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;LocalActorRef&lt;/code&gt; is &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/ActorRef.scala#L319&quot;&gt;coupled with &lt;code&gt;ActorCell&lt;/code&gt;&lt;/a&gt;, which is hidden from users as private and it is implementation details of how akka messaging works.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; LocalActorRef&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; ActorRefWithCell
 &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; LocalRef  &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; actorCell&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ActorCell &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;&quot;&gt;As you see below&lt;/a&gt;, &lt;code&gt;ActorCell&lt;/code&gt; has a reference to &lt;code&gt;Dispatcher&lt;/code&gt; (&lt;code&gt;val dispatcher: MessageDispatcher&lt;/code&gt;).&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; ActorCell&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; dispatcher&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;  MessageDispatcher&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; dungeon&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Dispatch &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;So when you do &lt;code&gt;actorRef ! &quot;hello&quot;&lt;/code&gt;, that &lt;code&gt;actorRef&lt;/code&gt; (whose type is &lt;code&gt;LocalActorRef&lt;/code&gt;) already knows what &lt;code&gt;Dispatcher&lt;/code&gt; to use via &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/ActorCell.scala#L370&quot;&gt;&lt;code&gt;ActorCell&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Also &lt;code&gt;ActorCell&lt;/code&gt; extends &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/dungeon/Dispatch.scala#L27&quot;&gt;&lt;code&gt;Dispatch&lt;/code&gt; trait&lt;/a&gt; and it has a refence to &lt;code&gt;Mailbox&lt;/code&gt;, so &lt;code&gt;LocalActorRef&lt;/code&gt; also knows which &lt;code&gt;Mailbox&lt;/code&gt; to send the massage, via &lt;code&gt;ActorCell&lt;/code&gt;. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;trait&lt;/span&gt; Dispatch &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ActorCell ⇒
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; mailbox&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Mailbox &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;This couping of &lt;code&gt;LocalActorRef&lt;/code&gt;, &lt;code&gt;ActorCell&lt;/code&gt;, and &lt;code&gt;Mailbox&lt;/code&gt; is what I meant by &lt;code&gt;Dispatcher&lt;/code&gt; doesn’t have routing capabilities in a “NOTE” earlier.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/sender-82d6c008ac87adf2e72a0389eab07010-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB2o2EIQn/xAAZEAACAwEAAAAAAAAAAAAAAAABEQACEhD/2gAIAQEAAQUCDddGMdyJ/8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQMBAT8BV//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABkQAAIDAQAAAAAAAAAAAAAAAAABESAiMf/aAAgBAQAGPwJmlFOH/8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAQRDB8P/aAAgBAQABPyFzWqc7XcFBGQOk/9oADAMBAAIAAwAAABATL//EABURAQEAAAAAAAAAAAAAAAAAAAAB/9oACAEDAQE/EEP/xAAVEQEBAAAAAAAAAAAAAAAAAAAAIf/aAAgBAgEBPxBH/8QAHBABAAICAwEAAAAAAAAAAAAAARExACEQUZFx/9oACAEBAAE/EAsXOak1XzDO6TQ34sQbQdPCSI04FB5Z/9k=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;sender&quot;
        title=&quot;&quot;
        src=&quot;/static/sender-82d6c008ac87adf2e72a0389eab07010-f8fb9.jpg&quot;
        srcset=&quot;/static/sender-82d6c008ac87adf2e72a0389eab07010-e8976.jpg 148w,
/static/sender-82d6c008ac87adf2e72a0389eab07010-63df2.jpg 295w,
/static/sender-82d6c008ac87adf2e72a0389eab07010-f8fb9.jpg 590w,
/static/sender-82d6c008ac87adf2e72a0389eab07010-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;&lt;code&gt;Dispatcher&lt;/code&gt;’s &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Dispatcher.scala#L52L56&quot;&gt;dispatch&lt;/a&gt; method is as follows:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; dispatch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  receiver&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ActorCell&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  invocation&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Envelope
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; mbox &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; receiver&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mailbox
  mbox&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;enqueue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;receiver&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; invocation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  registerForExecution&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mbox&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;where &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Dispatcher.scala#L115&quot;&gt;registerForExecution&lt;/a&gt; is:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; registerForExecution&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mbox&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Mailbox&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Boolean&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  executorService execute mbox
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;In the above code, &lt;code&gt;Dispatcher&lt;/code&gt;’s &lt;code&gt;excutorService&lt;/code&gt; is executing &lt;code&gt;mbox: Mailbox&lt;/code&gt;, because &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Mailbox.scala#L56L57&quot;&gt;&lt;code&gt;Mailbox&lt;/code&gt;&lt;/a&gt; extends &lt;code&gt;ForkJoinTask&lt;/code&gt;, which can be &lt;code&gt;execute&lt;/code&gt;-d by &lt;code&gt;ExecutorService&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/fork-join-1-a6354b55480d0404f2a1e8cc8cf61656-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdqyQA//xAAXEAEAAwAAAAAAAAAAAAAAAAABESAh/9oACAEBAAEFAtWK/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAADAAAAAAAAAAAAAAAAAAABIFH/2gAIAQEABj8Cgb//xAAYEAADAQEAAAAAAAAAAAAAAAABETEAIP/aAAgBAQABPyEN0Eyc/wD/2gAMAwEAAgADAAAAEMAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAEFAAAAAAAAAAAAAAAAAQARIEFhkf/aAAgBAQABPxAPOAJRZretv//Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;fork-join-1&quot;
        title=&quot;&quot;
        src=&quot;/static/fork-join-1-a6354b55480d0404f2a1e8cc8cf61656-f8fb9.jpg&quot;
        srcset=&quot;/static/fork-join-1-a6354b55480d0404f2a1e8cc8cf61656-e8976.jpg 148w,
/static/fork-join-1-a6354b55480d0404f2a1e8cc8cf61656-63df2.jpg 295w,
/static/fork-join-1-a6354b55480d0404f2a1e8cc8cf61656-f8fb9.jpg 590w,
/static/fork-join-1-a6354b55480d0404f2a1e8cc8cf61656-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/fork-join-2-05d3f1320821da8a2108754cfb8375e2-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHZW4GJD//EABgQAAMBAQAAAAAAAAAAAAAAAAABEAMS/9oACAEBAAEFAjPpxin/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAEQEgIv/aAAgBAQAGPwKWzVf/xAAbEAABBAMAAAAAAAAAAAAAAAABEBEhMQCB4f/aAAgBAQABPyEEvUeMYmY31Kr/AP/aAAwDAQACAAMAAAAQYw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEBAQACAwAAAAAAAAAAAAABESEAEFGBsf/aAAgBAQABPxCkQ2vEz5xoByQjT0utm+eEBhOv/9k=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;fork-join-2&quot;
        title=&quot;&quot;
        src=&quot;/static/fork-join-2-05d3f1320821da8a2108754cfb8375e2-f8fb9.jpg&quot;
        srcset=&quot;/static/fork-join-2-05d3f1320821da8a2108754cfb8375e2-e8976.jpg 148w,
/static/fork-join-2-05d3f1320821da8a2108754cfb8375e2-63df2.jpg 295w,
/static/fork-join-2-05d3f1320821da8a2108754cfb8375e2-f8fb9.jpg 590w,
/static/fork-join-2-05d3f1320821da8a2108754cfb8375e2-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; Mailbox&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; messageQueue&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; MessageQueue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; ForkJoinTask&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
  &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; SystemMessageQueue 
  &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; Runnable &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Execution (i.e. processing) of &lt;code&gt;Mailbox&lt;/code&gt; is run on a different &lt;code&gt;Thread&lt;/code&gt;, which was covered in &lt;a href=&quot;../local-minimal-receiver&quot;&gt;Local Actor workflow part 2 - Receiver side&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Dispatcher and receiver-side behavior&lt;/h2&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/fork-join-3-b8aff16a96f1775898c83f3ca43c0658-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHYV6JDD//EABoQAAICAwAAAAAAAAAAAAAAAAEQAAIREiH/2gAIAQEAAQUC7mmxRgX/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAACAwEAAAAAAAAAAAAAAAABEQAgIjH/2gAIAQEABj8CPVNMV//EABoQAAICAwAAAAAAAAAAAAAAAAEQITEAEXH/2gAIAQEAAT8huEyQM1TyKjf/2gAMAwEAAgADAAAAEFMP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAQACAgMAAAAAAAAAAAAAAREAIRAxUYGx/9oACAEBAAE/ELEOxDfXzDJKSBNnpeHAnnGtXj//2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;fork-join-3&quot;
        title=&quot;&quot;
        src=&quot;/static/fork-join-3-b8aff16a96f1775898c83f3ca43c0658-f8fb9.jpg&quot;
        srcset=&quot;/static/fork-join-3-b8aff16a96f1775898c83f3ca43c0658-e8976.jpg 148w,
/static/fork-join-3-b8aff16a96f1775898c83f3ca43c0658-63df2.jpg 295w,
/static/fork-join-3-b8aff16a96f1775898c83f3ca43c0658-f8fb9.jpg 590w,
/static/fork-join-3-b8aff16a96f1775898c83f3ca43c0658-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;When &lt;code&gt;run&lt;/code&gt; method of &lt;code&gt;ForkJoinTask&lt;/code&gt; is executed, the &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Mailbox.scala#L250&quot;&gt;following method of &lt;code&gt;Mailbox&lt;/code&gt;&lt;/a&gt; is called, &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@tailrec&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; processMailbox&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// def dequeue(): Envelope = messageQueue.dequeue()&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; next &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; dequeue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  actor invoke next
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  processMailbox&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;it picks up a message from the message queue, and process it.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/receiver-80a6300d25cf7552f05cceef167e99a5-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBP/EABUBAQEAAAAAAAAAAAAAAAAAAAME/9oADAMBAAIQAxAAAAHe70TFYyhf/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAETESIf/aAAgBAQABBQK36t4MOqPJ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAQMhEP/aAAgBAwEBPwELtOf/xAAZEQACAwEAAAAAAAAAAAAAAAABAgADESH/2gAIAQIBAT8BS5mOCDc7P//EABYQAQEBAAAAAAAAAAAAAAAAADEAIP/aAAgBAQAGPwJnP//EABgQAQEBAQEAAAAAAAAAAAAAAAEAITER/9oACAEBAAE/IV1sIR6yfs5woyAOX//aAAwDAQACAAMAAAAQ+A//xAAXEQEBAQEAAAAAAAAAAAAAAAABERBx/9oACAEDAQE/EHKWdz//xAAZEQACAwEAAAAAAAAAAAAAAAAAAREhQWH/2gAIAQIBAT8QZkqelTR//8QAHBABAAMAAgMAAAAAAAAAAAAAAQARITFRQcHw/9oACAEBAAE/EL5JwoNmO6xtP3qGbSdjMCcK3Ep0X5htCif/2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;receiver&quot;
        title=&quot;&quot;
        src=&quot;/static/receiver-80a6300d25cf7552f05cceef167e99a5-f8fb9.jpg&quot;
        srcset=&quot;/static/receiver-80a6300d25cf7552f05cceef167e99a5-e8976.jpg 148w,
/static/receiver-80a6300d25cf7552f05cceef167e99a5-63df2.jpg 295w,
/static/receiver-80a6300d25cf7552f05cceef167e99a5-f8fb9.jpg 590w,
/static/receiver-80a6300d25cf7552f05cceef167e99a5-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;So this &lt;code&gt;processMailbox&lt;/code&gt; method, called from &lt;code&gt;ForkJoinTask&lt;/code&gt;’s &lt;code&gt;run&lt;/code&gt; is what invokes your &lt;code&gt;receive&lt;/code&gt; method you defined in your &lt;code&gt;Actor&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; MyActor &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; Actor &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; receive &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;  
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;  
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;</content:encoded></item><item><title><![CDATA[Akka remoting minimal example part 3 - receiver side]]></title><description><![CDATA[Overview You can find the code and instruction to run the example at  GitHub . This is the last of three articles about akka’s remote…]]></description><link>https://richardimaoka.github.io/blog//remote-minimal-receiver/</link><guid isPermaLink="false">https://richardimaoka.github.io/blog//remote-minimal-receiver/</guid><pubDate>Fri, 09 Feb 2018 16:31:00 GMT</pubDate><content:encoded>&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;You can find the code and instruction to run the example at &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/remote-minimal&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe src=&quot;https://www.youtube.com/embed/YAuamfYBb1o&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;p&gt;This is the last of three articles about akka’s remote message passing. The previous articles are here:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;../remote-minimal-setup&quot;&gt;Akka remoting minimal example part 1 - setup&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;../remote-minimal-sender&quot;&gt;Akka remoting minimal example part 2 - sender side&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;TcpHandlers&lt;/h3&gt;
&lt;p&gt;As in the previous article, Netty takes care of the message transport in the network layer.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMBBP/EABUBAQEAAAAAAAAAAAAAAAAAAAIE/9oADAMBAAIQAxAAAAHuWwxxXJ//xAAYEAADAQEAAAAAAAAAAAAAAAAAAhEBMf/aAAgBAQABBQI2xbFRVGM5/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAECEf/aAAgBAwEBPwGZRh//xAAYEQADAQEAAAAAAAAAAAAAAAAAARECA//aAAgBAgEBPwFc4PNZ/8QAFxAAAwEAAAAAAAAAAAAAAAAAABAhAf/aAAgBAQAGPwJUmP8A/8QAGxABAQABBQAAAAAAAAAAAAAAAREAECExgZH/2gAIAQEAAT8h6fMlQNwvabiCyvOq/9oADAMBAAIAAwAAABCLD//EABYRAQEBAAAAAAAAAAAAAAAAAAEQIf/aAAgBAwEBPxADk//EABcRAQEBAQAAAAAAAAAAAAAAAAEAETH/2gAIAQIBAT8QFbCjy//EAB4QAQADAAAHAAAAAAAAAAAAAAEAESExQVFhcZHw/9oACAEBAAE/EBVQVOigWgjCmAk1u/CWuPKXfrZgPM0Vv3P/2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;netty&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-e8976.jpg 148w,
/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-63df2.jpg 295w,
/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-f8fb9.jpg 590w,
/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Onc the receiver side, &lt;code&gt;TcpHandler&lt;/code&gt; has the &lt;code&gt;onMessage&lt;/code&gt; method, which is called when a message payload (serialized byte array) arrives on the receiver side. &lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/tcphandler-7a5f4eb307023f066db3ba2a77eaa318-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEA//EABYBAQEBAAAAAAAAAAAAAAAAAAIABP/aAAwDAQACEAMQAAABparOxqUBH//EABoQAAICAwAAAAAAAAAAAAAAAAESAhEAEDH/2gAIAQEAAQUCizBro6j3P//EABYRAQEBAAAAAAAAAAAAAAAAAAASAf/aAAgBAwEBPwGcS//EABcRAQADAAAAAAAAAAAAAAAAAAABAhP/2gAIAQIBAT8BmrJ//8QAGRAAAgMBAAAAAAAAAAAAAAAAAREAAiAh/9oACAEBAAY/Ai6lToz/AP/EABoQAQADAAMAAAAAAAAAAAAAAAEAESEQQWH/2gAIAQEAAT8hTIQ7my4J4MveGp//2gAMAwEAAgADAAAAEBMf/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAERQVH/2gAIAQMBAT8QdhHT/8QAGREAAwADAAAAAAAAAAAAAAAAAAERIVGh/9oACAECAQE/EEuxLPCdn//EABsQAQACAwEBAAAAAAAAAAAAAAEAESExcUHx/9oACAEBAAE/EE+w0jDmcgik+FBtVxc069lecan/2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;tcphandler&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/tcphandler-7a5f4eb307023f066db3ba2a77eaa318-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/tcphandler-7a5f4eb307023f066db3ba2a77eaa318-e8976.jpg 148w,
/blog/static/tcphandler-7a5f4eb307023f066db3ba2a77eaa318-63df2.jpg 295w,
/blog/static/tcphandler-7a5f4eb307023f066db3ba2a77eaa318-f8fb9.jpg 590w,
/blog/static/tcphandler-7a5f4eb307023f066db3ba2a77eaa318-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;trait&lt;/span&gt; TcpHandlers &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; onMessage&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    notifyListener&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
      InboundPayload&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ByteString&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bytes&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;The above &lt;code&gt;notifyListener&lt;/code&gt;  method is as follows:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; notifyListener&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;channel&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Channel&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; HandleEvent&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; 
    get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;channel&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; foreach &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; _ notify msg &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;and &lt;code&gt;notify&lt;/code&gt; performs usual local message passing via the familiar &lt;code&gt;!&lt;/code&gt; method, &lt;code&gt;actor ! ev&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;  final case class ActorHandleEventListener(actor: ActorRef) 
    extends HandleEventListener {
    
    override def notify(ev: HandleEvent): Unit =
      actor ! ev
  }&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;EndPointReader and de-serialization&lt;/h3&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/deserialize-de187b0aca391605b3c8af965f49e7a7-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAgAE/8QAFwEAAwEAAAAAAAAAAAAAAAAAAAEEBf/aAAwDAQACEAMQAAAB1JU+cJwv/8QAFxABAQEBAAAAAAAAAAAAAAAAEQEgIf/aAAgBAQABBQKK8jj/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAwEBPwGn/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQACEf/aAAgBAgEBPwHT2W//xAAXEAADAQAAAAAAAAAAAAAAAAAAASAx/9oACAEBAAY/AjHP/8QAGBABAAMBAAAAAAAAAAAAAAAAAQARISD/2gAIAQEAAT8h02ZN2JNFonH/2gAMAwEAAgADAAAAEDff/8QAFhEBAQEAAAAAAAAAAAAAAAAAAREA/9oACAEDAQE/ECWzLXf/xAAXEQEBAQEAAAAAAAAAAAAAAAABEQBx/9oACAECAQE/EAdk5gWhN//EABkQAQADAQEAAAAAAAAAAAAAAAEAESEgMf/aAAgBAQABPxB12r5LIg7jjGeoaF2uP//Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;deserialize&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/deserialize-de187b0aca391605b3c8af965f49e7a7-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/deserialize-de187b0aca391605b3c8af965f49e7a7-e8976.jpg 148w,
/blog/static/deserialize-de187b0aca391605b3c8af965f49e7a7-63df2.jpg 295w,
/blog/static/deserialize-de187b0aca391605b3c8af965f49e7a7-f8fb9.jpg 590w,
/blog/static/deserialize-de187b0aca391605b3c8af965f49e7a7-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;There are some intermediate actor(s) passes through the payload after the &lt;code&gt;notify&lt;/code&gt; method described above (in the case of this example, &lt;code&gt;AkkaProtocolManager&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Afterwards, an important &lt;code&gt;EndpointReader&lt;/code&gt; actor receives the payload. It has the following &lt;code&gt;receive&lt;/code&gt; method.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; EndpointReader&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; receive&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Receive &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; InboundPayload&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;p&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;size &lt;span class=&quot;token operator&quot;&gt;&amp;lt;=&lt;/span&gt; transport&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;maximumPayloadBytes ⇒
      &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;     
      msgDispatch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dispatch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        msg&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;recipient&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        msg&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;recipientAddress&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// msg.serializedMessage.message: ByteString &lt;/span&gt;
        msg&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;serializedMessage&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        msg&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;senderOption
      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;        
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;When &lt;code&gt;EndPointReader&lt;/code&gt; receives the payload, it is de-serialized from a serialized byte array (represented as &lt;code&gt;ByteString&lt;/code&gt;) to a Scala object, with the following call in &lt;code&gt;DefaultMessageDispatcher&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;class DefaultMessageDispatcher(
    ...
    lazy val payload: AnyRef =
      MessageSerializer.deserialize(
        system, 
        serializedMessage
      )
    ...
}&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;&lt;code&gt;msgDispatch.dispatch&lt;/code&gt; in &lt;code&gt;EndPointReader&lt;/code&gt; finally passes the deserialized message to the &lt;code&gt;MessageReceiver&lt;/code&gt; actor via local message passing.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/receiver-5310b90ed8761a134f9b10a3a878337f-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAgAE/8QAFwEAAwEAAAAAAAAAAAAAAAAAAAEEBf/aAAwDAQACEAMQAAAB0p0+cJwv/8QAGRAAAgMBAAAAAAAAAAAAAAAAARECEBIh/9oACAEBAAEFAgTp8i1f/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Bp//EABYRAQEBAAAAAAAAAAAAAAAAAAEAEf/aAAgBAgEBPwFdZdb/xAAXEAADAQAAAAAAAAAAAAAAAAABECEg/9oACAEBAAY/AjFcf//EABkQAQEBAAMAAAAAAAAAAAAAAAERACAhUf/aAAgBAQABPyGQVDd1BHx1OB//2gAMAwEAAgADAAAAEEz/AP/EABYRAQEBAAAAAAAAAAAAAAAAAAEAEf/aAAgBAwEBPxBDbf/EABYRAQEBAAAAAAAAAAAAAAAAAAERAP/aAAgBAgEBPxAQZMaITf/EABwQAQACAQUAAAAAAAAAAAAAAAEAETEQIUFRcf/aAAgBAQABPxBPAk9yzt2UFMVwI35EHJADGn//2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;receiver&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/receiver-5310b90ed8761a134f9b10a3a878337f-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/receiver-5310b90ed8761a134f9b10a3a878337f-e8976.jpg 148w,
/blog/static/receiver-5310b90ed8761a134f9b10a3a878337f-63df2.jpg 295w,
/blog/static/receiver-5310b90ed8761a134f9b10a3a878337f-f8fb9.jpg 590w,
/blog/static/receiver-5310b90ed8761a134f9b10a3a878337f-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;h2&gt;Instruction to run the example, and output&lt;/h2&gt;
&lt;p&gt;As this example uses &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/remoting.html&quot;&gt;Akka remoting&lt;/a&gt; to send a message,
you need to run two JVMs for the receiver and sender of the application respectively.&lt;/p&gt;
&lt;p&gt;Firstly, run the receiver side with the &lt;code&gt;receiver&lt;/code&gt; argument supplied to &lt;code&gt;Main&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; git clone https://github.com/richardimaoka/resources.git
&gt; cd resources
&gt; cd remote-minimal
&gt; sbt
&gt; runMain example.Main receiver&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;You’ll get output like below, then it waits until the message is sent from the sender.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; runMain example.Main receiver
[info] Running example.Main receiver
Program args:
receiver
running startMessageReceiver()
[INFO] [02/03/2018 13:36:58.281] [run-main-0] [akka.remote.Remoting] Starting remoting
[INFO] [02/03/2018 13:36:58.462] [run-main-0] [akka.remote.Remoting] Remoting started; listening on addresses :[akka.tcp://receiverSystem@127.0.0.1:2551]
[INFO] [02/03/2018 13:36:58.464] [run-main-0] [akka.remote.Remoting] Remoting now listens on addresses: [akka.tcp://receiverSystem@127.0.0.1:2551]
provider = remote
listening at port = 2551
started a receiver actor = Actor[akka://receiverSystem/user/receiver#-603875191]&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Then in the same directory, run the same &lt;code&gt;Main&lt;/code&gt; with &lt;code&gt;sender&lt;/code&gt; as the argument&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; sbt
&gt; runMain example.Main sender&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;this is the sender side output:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[info] Running example.Main sender
Program args:
sender
running startMessageSender()
[INFO] [02/03/2018 13:37:16.215] [run-main-0] [akka.remote.Remoting] Starting remoting
[INFO] [02/03/2018 13:37:16.427] [run-main-0] [akka.remote.Remoting] Remoting started; listening on addresses :[akka.tcp://senderSystem@127.0.0.1:2552]
[INFO] [02/03/2018 13:37:16.432] [run-main-0] [akka.remote.Remoting] Remoting now listens on addresses: [akka.tcp://senderSystem@127.0.0.1:2552]
provider = remote
listening at port = 2552
sending a message to akka.tcp://receiverSystem@127.0.0.1:2551/user/receiver
[INFO] [02/03/2018 13:37:19.533] [senderSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://senderSystem@127.0.0.1:2552/system/remoting-terminator] Shutting down remote daemon.
[INFO] [02/03/2018 13:37:19.537] [senderSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://senderSystem@127.0.0.1:2552/system/remoting-terminator] Remote daemon shut down; proceeding with flushing remote transports.
[INFO] [02/03/2018 13:37:19.577] [senderSystem-akka.actor.default-dispatcher-4] [akka.remote.Remoting] Remoting shut down
[INFO] [02/03/2018 13:37:19.577] [senderSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://senderSystem@127.0.0.1:2552/system/remoting-terminator] Remoting shut down.
[success] Total time: 5 s, completed Feb 3, 2018 1:37:19 PM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;then you see the receiver output as follows:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;EchoActor: received message = Hello!!&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;and immediately after that, the receiver side shows this error, which can be ignored.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[ERROR] [02/03/2018 13:37:19.572] [receiverSystem-akka.remote.default-remote-dispatcher-15] [akka.tcp://receiverSystem@127.0.0.1:2551/system/endpointManager/reliableEndpointWriter-akka.tcp%3A%2F%2FsenderSystem%40127.0.0.1%3A2552-0/endpointWriter] AssociationError [akka.tcp://receiverSystem@127.0.0.1:2551] &lt;- [akka.tcp://senderSystem@127.0.0.1:2552]: Error [Shut down address: akka.tcp://senderSystem@127.0.0.1:2552] [
akka.remote.ShutDownAssociation: Shut down address: akka.tcp://senderSystem@127.0.0.1:2552
Caused by: akka.remote.transport.Transport$InvalidAssociationException: The remote system terminated the association because it is shutting down.
]&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;As explained in &lt;a href=&quot;https://groups.google.com/forum/#!topic/akka-user/eerWNwRQ7o0&quot;&gt;this thrad in akka-user&lt;/a&gt; mailing list, the error happens specifically when you launch a process like this example from sbt, but when you compile your application and run it witout sbt, then the error disappears.&lt;/p&gt;
&lt;p&gt;Once everything is done, press the enter key on the receiver side’s console and you get this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[INFO] [02/03/2018 13:38:05.942] [receiverSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://receiverSystem@127.0.0.1:2551/system/remoting-terminator] Shutting down remote daemon.
[INFO] [02/03/2018 13:38:05.944] [receiverSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://receiverSystem@127.0.0.1:2551/system/remoting-terminator] Remote daemon shut down; proceeding with flushing remote transports.
[INFO] [02/03/2018 13:38:05.960] [receiverSystem-akka.actor.default-dispatcher-3] [akka.remote.Remoting] Remoting shut down
[INFO] [02/03/2018 13:38:05.960] [receiverSystem-akka.remote.default-remote-dispatcher-6] [akka.tcp://receiverSystem@127.0.0.1:2551/system/remoting-terminator] Remoting shut down.&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Official documentation of Akka remoting at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/remoting.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/remoting.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Official documentation of Akka serialization at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/serialization.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/serialization.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Netty documentation at &lt;a href=&quot;https://netty.io/&quot;&gt;https://netty.io/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Executor/ExecutorService in Java, and ExecutionContext behind Future in Scala]]></title><description><![CDATA[Overview You can find the code and instruction to run the example at  GitHub . Thread in Java Thread  and  Runnable  has been there for long…]]></description><link>https://richardimaoka.github.io/blog//executor-and-execution-context/</link><guid isPermaLink="false">https://richardimaoka.github.io/blog//executor-and-execution-context/</guid><pubDate>Wed, 07 Feb 2018 16:31:08 GMT</pubDate><content:encoded>&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;You can find the code and instruction to run the example at &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/executor-and-execution-context&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe src=&quot;https://www.youtube.com/embed/zgp2B-cuUMI&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;h2&gt;Thread in Java&lt;/h2&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/thread-46cd166852cb3bb57e031d8bab405132-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAAB6ChmhioL/8QAFxABAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAQABBQLuuxshIQX/xAAWEQADAAAAAAAAAAAAAAAAAAAAARP/2gAIAQMBAT8BiiKP/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAISE//aAAgBAgEBPwHRy3P/xAAWEAEBAQAAAAAAAAAAAAAAAABBACD/2gAIAQEABj8CZz//xAAbEAABBAMAAAAAAAAAAAAAAAAAAREhMVFxkf/aAAgBAQABPyFcnRRLNkVqOiEIsf/aAAwDAQACAAMAAAAQvC//xAAYEQACAwAAAAAAAAAAAAAAAAAAAREhMf/aAAgBAwEBPxCqBIWn/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAFx/9oACAECAQE/EMUX/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARITFBkaH/2gAIAQEAAT8Qz7rvkItMblmW57+rFNp9YhwdcWB0+z//2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;thread&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/thread-46cd166852cb3bb57e031d8bab405132-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/thread-46cd166852cb3bb57e031d8bab405132-e8976.jpg 148w,
/blog/static/thread-46cd166852cb3bb57e031d8bab405132-63df2.jpg 295w,
/blog/static/thread-46cd166852cb3bb57e031d8bab405132-f8fb9.jpg 590w,
/blog/static/thread-46cd166852cb3bb57e031d8bab405132-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;&lt;code&gt;Thread&lt;/code&gt; and &lt;code&gt;Runnable&lt;/code&gt; has been there for long as the very first generation of concurrent execution approaches in Java. The concept and usage are rather simple, where you extend &lt;code&gt;Runnable&lt;/code&gt; and implement the &lt;code&gt;run&lt;/code&gt; method which represents the operation you want to execute concurrently.&lt;/p&gt;
&lt;p&gt;(&lt;code&gt;Runnable&lt;/code&gt; is from Java, but here I’m defining a Scala class extending it.)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; PrintRunnable &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; Runnable &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    println&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token string&quot;&gt;&quot;[${Thread.currentThread()}] - PrintRunnable run() is executed&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html&quot;&gt;javadoc of &lt;code&gt;Runnable&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Then you instantiate a &lt;code&gt;Thread&lt;/code&gt; by passing in a &lt;code&gt;Runnable&lt;/code&gt; instance, and call the &lt;code&gt;start()&lt;/code&gt; method.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;println&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token string&quot;&gt;&quot;[${Thread.currentThread()}] - main thread&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
t &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; Thread&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; PrintRunnable&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;start&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html&quot;&gt;javadoc of &lt;code&gt;Thread&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Then you will get output like this. The &lt;code&gt;Thread&lt;/code&gt; names are enclosed in &lt;code&gt;[]&lt;/code&gt;, which show that the main thread - (i.e.) one which did &lt;code&gt;t = new Thread(new PrintRunnable(1))&lt;/code&gt; - and the thread running &lt;code&gt;Runnable&lt;/code&gt; are different - (i.e.) Concurrently executed.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[Thread[run-main-0,5,run-main-group-0]] - main thread
[Thread[pool-8-thread-1,5,run-main-group-0]] - PrintRunnable run() is executed&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Typically after you call the &lt;code&gt;start()&lt;/code&gt; method of &lt;code&gt;Thread&lt;/code&gt;, you also call the &lt;code&gt;join()&lt;/code&gt; method to wait until the thrad dies.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;Executor and ExecutorService in Java&lt;/h2&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/interfaces-58c9ff9873a22582e5b84a6f127af378-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe7WiVD/xAAVEAEBAAAAAAAAAAAAAAAAAAAgIf/aAAgBAQABBQKr/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGxAAAgEFAAAAAAAAAAAAAAAAAAERICExQXH/2gAIAQEAAT8h7Q8WFO6P/9oADAMBAAIAAwAAABCAD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAAICAwEAAAAAAAAAAAAAAAERACEgMUFx/9oACAEBAAE/EE1q8hkF1K92+BYf/9k=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;interfaces&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/interfaces-58c9ff9873a22582e5b84a6f127af378-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/interfaces-58c9ff9873a22582e5b84a6f127af378-e8976.jpg 148w,
/blog/static/interfaces-58c9ff9873a22582e5b84a6f127af378-63df2.jpg 295w,
/blog/static/interfaces-58c9ff9873a22582e5b84a6f127af378-f8fb9.jpg 590w,
/blog/static/interfaces-58c9ff9873a22582e5b84a6f127af378-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;The next generation of Java concurrency execution approach was &lt;code&gt;Executor&lt;/code&gt; and &lt;code&gt;ExecutorService&lt;/code&gt;.
While &lt;code&gt;Thread&lt;/code&gt; allowed you handle concurrent execution in a separate thread, but when it comes to the point where you handle many threads for many different purposes in the same application, it becomes unmanagable.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Executor&lt;/code&gt; and &lt;code&gt;ExecutorService&lt;/code&gt; control &lt;code&gt;Thread&lt;/code&gt; instances in the background so that you don’t handle each single &lt;code&gt;Thread&lt;/code&gt; by yourself, which is tedious, but rather you do higher level of control by handling a group of &lt;code&gt;Thread&lt;/code&gt; instances (&lt;code&gt;ThreadPool&lt;/code&gt;, which is not explained in this article though) via &lt;code&gt;ExecutorService&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Let’s look at the code - firstly &lt;code&gt;Executor&lt;/code&gt; is a very simple interface which only has this single &lt;code&gt;execute&lt;/code&gt; method.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-java&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Executor&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;/**
     * Executes the given command at some time in the future.  The command
     * may execute in a new thread, in a pooled thread, or in the calling
     * thread, at the discretion of the {@code Executor} implementation.
     *
     * @param command the runnable task
     * @throws RejectedExecutionException if this task cannot be
     * accepted for execution
     * @throws NullPointerException if command is null
     */&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Runnable command&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executor.html&quot;&gt;javadoc of &lt;code&gt;Executor&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;And &lt;code&gt;ExecutorService&lt;/code&gt; is also a Java &lt;code&gt;interface&lt;/code&gt; which extends &lt;code&gt;Executor&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-java&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ExecutorService&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Executor&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;and define those lifecycle management methods (and some other methods).&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-java&quot;&gt;&lt;code&gt;  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;shutdown&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  List&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Runnable&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;shutdownNow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;isShutdown&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;isTerminated&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;awaitTermination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; timeout&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; TimeUnit unit&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; InterruptedException&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html&quot;&gt;javadoc of &lt;code&gt;ExecutorService&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;There are factory methods available in the &lt;code&gt;Executors&lt;/code&gt; class like this one, which creates a group of 5 threads in the background:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;val executor = Executors.newFixedThreadPool(5);
executor.execute(new PrintRunnable)&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/executorService-91862e98b381bb414a432b8afa9ae502-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMBBf/EABYBAQEBAAAAAAAAAAAAAAAAAAADBP/aAAwDAQACEAMQAAAB6S+54wXH/8QAGRAAAwEBAQAAAAAAAAAAAAAAAAERIQIS/9oACAEBAAEFAtvN9aTUkRH/xAAWEQADAAAAAAAAAAAAAAAAAAAAARP/2gAIAQMBAT8BkiKP/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAISE//aAAgBAgEBPwHRy3P/xAAYEAACAwAAAAAAAAAAAAAAAAAAMQEgQf/aAAgBAQAGPwLSGOn/xAAbEAACAQUAAAAAAAAAAAAAAAAAATEhQVFh8P/aAAgBAQABPyHmyZF1U5EpSaNR/9oADAMBAAIAAwAAABBc7//EABgRAAIDAAAAAAAAAAAAAAAAAAABIVFh/9oACAEDAQE/EJk6ND//xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QEQcl/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARIUFRMWH/2gAIAQEAAT8QG0FNvzHnKXm2GfS2gbU3btiGDZ5lgC9PWf/Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;executorService&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/executorService-91862e98b381bb414a432b8afa9ae502-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/executorService-91862e98b381bb414a432b8afa9ae502-e8976.jpg 148w,
/blog/static/executorService-91862e98b381bb414a432b8afa9ae502-63df2.jpg 295w,
/blog/static/executorService-91862e98b381bb414a432b8afa9ae502-f8fb9.jpg 590w,
/blog/static/executorService-91862e98b381bb414a432b8afa9ae502-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/executorService2-41484c3a90ad5f1e855f031beb002e89-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAMAAf/aAAwDAQACEAMQAAAB0nZgMC5l/8QAGhAAAwADAQAAAAAAAAAAAAAAAAERAhIhQf/aAAgBAQABBQL3G7dIqkiI/8QAFhEAAwAAAAAAAAAAAAAAAAAAAAET/9oACAEDAQE/AZIij//EABYRAAMAAAAAAAAAAAAAAAAAAAACEv/aAAgBAgEBPwG3Lc//xAAYEAACAwAAAAAAAAAAAAAAAAAAASAxQf/aAAgBAQAGPwLRFw//xAAcEAACAgIDAAAAAAAAAAAAAAAAASFBEZExUWH/2gAIAQEAAT8hm+5cPZaXPYipNYR5H//aAAwDAQACAAMAAAAQlO//xAAYEQACAwAAAAAAAAAAAAAAAAAAASFRYf/aAAgBAwEBPxCZOjQ//8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QGQZf/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARITFRQWH/2gAIAQEAAT8QG7Zb8xu2m83Bn0vUBanb6xzorWWAL09Z/9k=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;executorService2&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/executorService2-41484c3a90ad5f1e855f031beb002e89-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/executorService2-41484c3a90ad5f1e855f031beb002e89-e8976.jpg 148w,
/blog/static/executorService2-41484c3a90ad5f1e855f031beb002e89-63df2.jpg 295w,
/blog/static/executorService2-41484c3a90ad5f1e855f031beb002e89-f8fb9.jpg 590w,
/blog/static/executorService2-41484c3a90ad5f1e855f031beb002e89-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;and the &lt;code&gt;execute&lt;/code&gt; call let &lt;code&gt;ExecutorService&lt;/code&gt; execute &lt;code&gt;PrintRunnable&lt;/code&gt; in the background threads.
Note that you didn’t specify which exact thread the &lt;code&gt;PrintRunnable&lt;/code&gt; should be run in, but instead, you asked &lt;code&gt;ExecutorService&lt;/code&gt; to decide the actual thread to run it.&lt;/p&gt;
&lt;h2&gt;ExecutionContext, and how it works with Future&lt;/h2&gt;
&lt;p&gt;Now we move onto Scala’s &lt;code&gt;Future&lt;/code&gt;. Scala’s &lt;code&gt;Future&lt;/code&gt; is used with Scala’s &lt;code&gt;ExecutionContext&lt;/code&gt;, both of which I will explain below in the article.&lt;/p&gt;
&lt;p&gt;(I’m intentionally saying &lt;strong&gt;Scala’s&lt;/strong&gt; &lt;code&gt;Future&lt;/code&gt; as there is also Java’s &lt;code&gt;Future&lt;/code&gt; and that is different from Scala’s. I will not talk about the Java &lt;code&gt;Future&lt;/code&gt; in this article.)&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/executionContext-be4b22319ed9bc62a679ef6265984d2d-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe61CqP/xAAXEAEAAwAAAAAAAAAAAAAAAAAQABFB/9oACAEBAAEFAppR/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRABAAMBAQAAAAAAAAAAAAAAARARQQBh/9oACAEBAAE/IRMvhXxNDI//2gAMAwEAAgADAAAAEPMP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAQEAAwEAAAAAAAAAAAAAAREAECFRYf/aAAgBAQABPxA1j6uURvjV8cgkezCqAeP/2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;executionContext&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/executionContext-be4b22319ed9bc62a679ef6265984d2d-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/executionContext-be4b22319ed9bc62a679ef6265984d2d-e8976.jpg 148w,
/blog/static/executionContext-be4b22319ed9bc62a679ef6265984d2d-63df2.jpg 295w,
/blog/static/executionContext-be4b22319ed9bc62a679ef6265984d2d-f8fb9.jpg 590w,
/blog/static/executionContext-be4b22319ed9bc62a679ef6265984d2d-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;You can think of &lt;code&gt;ExecutionContext&lt;/code&gt; in Scala is kind of equivalent to &lt;code&gt;Executor&lt;/code&gt; in Java.
It has the following &lt;code&gt;execute&lt;/code&gt; method.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;trait ExecutionContext {
  def execute(runnable: Runnable): Unit
  .. // only few other methods (two other methods as of Scala 2.12.4)
}&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/future-e7f56e76d0381aaa9c0f3945591632c5-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAIDBP/aAAwDAQACEAMQAAAB0Hq2eKFRr//EABgQAQADAQAAAAAAAAAAAAAAAAABESFB/9oACAEBAAEFAta7UKhT/8QAFREBAQAAAAAAAAAAAAAAAAAAABP/2gAIAQMBAT8Bim//xAAWEQADAAAAAAAAAAAAAAAAAAAAAhL/2gAIAQIBAT8BtymP/8QAFxAAAwEAAAAAAAAAAAAAAAAAARAgcf/aAAgBAQAGPwJHY//EABoQAAIDAQEAAAAAAAAAAAAAAAABESExQXH/2gAIAQEAAT8hd3ZpW+F6MOYuwhL9P//aAAwDAQACAAMAAAAQsA//xAAWEQADAAAAAAAAAAAAAAAAAAAAEVH/2gAIAQMBAT8QSiU//8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QJX//xAAcEAEAAgMAAwAAAAAAAAAAAAABABEhMUFRcZH/2gAIAQEAAT8QZqe3rBVlx5sPfFZjm0/Wbm2OsylbS5n/2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;future&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/future-e7f56e76d0381aaa9c0f3945591632c5-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/future-e7f56e76d0381aaa9c0f3945591632c5-e8976.jpg 148w,
/blog/static/future-e7f56e76d0381aaa9c0f3945591632c5-63df2.jpg 295w,
/blog/static/future-e7f56e76d0381aaa9c0f3945591632c5-f8fb9.jpg 590w,
/blog/static/future-e7f56e76d0381aaa9c0f3945591632c5-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;However, you don’t call the &lt;code&gt;execute()&lt;/code&gt; method of &lt;code&gt;ExecutionContext&lt;/code&gt; directly, but you should  &lt;code&gt;implicit&lt;/code&gt;ly declare &lt;code&gt;ExecutionContext&lt;/code&gt; like below.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;implicit val executionContext: ExecutionContext = 
  ExecutionContext.Implicits.global&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;(Little bit side-tracked, but in production code, you shouldn’t use &lt;code&gt;ExecutionContext.Implicits.global&lt;/code&gt;, as you will need more flexibility and careful configuration of the background thread pool, like number of threads, whether it’s fixed thread pool or fork-join, etc)&lt;/p&gt;
&lt;p&gt;Then you call &lt;code&gt;Future{...}&lt;/code&gt; which is &lt;code&gt;Future&lt;/code&gt; companion object’s &lt;code&gt;apply&lt;/code&gt; method, &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;def printThreadInsideFuture(): Unit = 
  println(s&quot;[${Thread.currentThread()}] - printThreadInsideFuture() is executed&quot;)

val f = Future{ printThreadInsideFuture() }  &lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;that takes an &lt;code&gt;implicit&lt;/code&gt; parameter of &lt;code&gt;ExecutionContext&lt;/code&gt;. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; apply&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;T&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;body&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;=&gt;&lt;/span&gt;T&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
             &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;implicit&lt;/span&gt; executor&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ExecutionContext&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Future&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;T&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;By doing this, you let the &lt;code&gt;implicit&lt;/code&gt;-ly passed &lt;code&gt;ExecutionContext&lt;/code&gt; execute the body of &lt;code&gt;Future&lt;/code&gt; you passed in, in one of the background threads.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/onComplete-385cb92e7c1a00a9b73343a2e2150e71-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAIDBP/aAAwDAQACEAMQAAAB0Hq2eKFRr//EABgQAAMBAQAAAAAAAAAAAAAAAAABESFB/9oACAEBAAEFAtp2IiIf/8QAFREBAQAAAAAAAAAAAAAAAAAAABP/2gAIAQMBAT8Bim//xAAWEQADAAAAAAAAAAAAAAAAAAAAAhL/2gAIAQIBAT8BtymP/8QAGBAAAgMAAAAAAAAAAAAAAAAAAAEgMXH/2gAIAQEABj8CLHsP/8QAGxAAAwACAwAAAAAAAAAAAAAAAAERIUExYXH/2gAIAQEAAT8hbplldWWtmeRh2Ooiv0//2gAMAwEAAgADAAAAELAP/8QAFhEAAwAAAAAAAAAAAAAAAAAAABFR/9oACAEDAQE/EEolP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/ECV//8QAHBABAAIDAAMAAAAAAAAAAAAAAQARITFBYXGR/9oACAEBAAE/EBAbfMIpHvisxzafrFkvSuvJlK2lzP/Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;onComplete&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/onComplete-385cb92e7c1a00a9b73343a2e2150e71-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/onComplete-385cb92e7c1a00a9b73343a2e2150e71-e8976.jpg 148w,
/blog/static/onComplete-385cb92e7c1a00a9b73343a2e2150e71-63df2.jpg 295w,
/blog/static/onComplete-385cb92e7c1a00a9b73343a2e2150e71-f8fb9.jpg 590w,
/blog/static/onComplete-385cb92e7c1a00a9b73343a2e2150e71-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Scala’s &lt;code&gt;Future&lt;/code&gt; also has &lt;code&gt;onComplete&lt;/code&gt; method which lets you execute a callback function taking the return value from the &lt;code&gt;Future&lt;/code&gt; body you earlier passed.&lt;/p&gt;
&lt;p&gt;The callback should have &lt;code&gt;case Success()&lt;/code&gt; and &lt;code&gt;case Future&lt;/code&gt; because a &lt;code&gt;Future&lt;/code&gt; can fail without completing the passed-in &lt;code&gt;Future&lt;/code&gt; body for whatever reasons.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; printThreadInsideCallback&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; 
  println&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token string&quot;&gt;&quot;[${Thread.currentThread()}] - printThreadInsideCallback() is executed&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// The callback passed to onComplete is either be &lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// applied immediately or be scheduled asynchronously.&lt;/span&gt;
f1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;onComplete&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; Success&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;_&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;=&gt;&lt;/span&gt; 
    printThreadInsideCallback&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; Failure&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;_&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;=&gt;&lt;/span&gt;
    println&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Future failed!!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;In &lt;a href=&quot;https://www.scala-lang.org/api/2.12.4/scala/concurrent/Future.html&quot;&gt;Scaladoc&lt;/a&gt;, &lt;code&gt;Future&lt;/code&gt;’s &lt;code&gt;onComplete&lt;/code&gt; has the following comment, explaining its behavior.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;When this future is completed, either through an exception, or a value,
apply the provided function.

If the future has already been completed,
this will either be applied immediately or be scheduled asynchronously.

Note that the returned value of `f` will be discarded.&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Details of &lt;code&gt;onComplete&lt;/code&gt; can be found in &lt;a href=&quot;https://docs.scala-lang.org/overviews/core/futures.html&quot;&gt;the official &lt;code&gt;Future&lt;/code&gt; doc&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Inter-operabilities between Executor/ExecutorService and ExecutionContext&lt;/h2&gt;
&lt;p&gt;You might get into a situation where you have a Scala application dependent on some Java libraries, which only expects &lt;code&gt;Executor&lt;/code&gt; or &lt;code&gt;ExecutionContext&lt;/code&gt;, not knowing Scala &lt;code&gt;ExecutionContext&lt;/code&gt; at all.&lt;/p&gt;
&lt;p&gt;To deal with such a situation, Scala provides the following two traits bridging the gap between &lt;code&gt;Executor&lt;/code&gt;/&lt;code&gt;ExecutorService&lt;/code&gt; and &lt;code&gt;ExecutionContext&lt;/code&gt;. You’ll create an instance of eitehr &lt;code&gt;ExecutionContextExecutor&lt;/code&gt; or &lt;code&gt;ExecutionContextExecutorService&lt;/code&gt;, then that can be passed as &lt;code&gt;Executor&lt;/code&gt;/&lt;code&gt;ExecutorService&lt;/code&gt; to Java libraries, as well as &lt;code&gt;ExecutionContext&lt;/code&gt; to Scala libraries.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;/**
 * An ExecutionContext that is also a
 * Java Executor.
 */
trait ExecutionContextExecutor 
  extends ExecutionContext 
  with Executor&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token comment&quot;&gt;/**
 * An ExecutionContext that is also a
 * Java ExecutorService.
 */&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;trait&lt;/span&gt; ExecutionContextExecutorService 
  &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; ExecutionContextExecutor 
  &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; ExecutorService
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;(Indeed for example, Akka’s &lt;code&gt;Dispatcher&lt;/code&gt; extends &lt;code&gt;ExecutionContextExecutor&lt;/code&gt; so that it works as &lt;code&gt;ExecutionContext&lt;/code&gt; to run &lt;code&gt;Future&lt;/code&gt; bodies, and &lt;code&gt;Executor&lt;/code&gt; to work in Java libraries)&lt;/p&gt;
&lt;h2&gt;Instruction to run the example, and output&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; git clone https://github.com/richardimaoka/resources.git
&gt; cd resources
&gt; cd executor-and-execution-context
&gt; sbt&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;There are multiple &lt;code&gt;object Main&lt;/code&gt; defined under separate packages.
So, to run the thread example under the &lt;code&gt;example.thread&lt;/code&gt; package:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; runMain example.thread.Main&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[info] Running example.thread.Main
[Thread[run-main-1,5,run-main-group-1]] - main thread
[Thread[Thread-4,5,run-main-group-1]] - PrintRunnable(2) run() is executed
[Thread[Thread-3,5,run-main-group-1]] - PrintRunnable(1) run() is executed
[Thread[Thread-6,5,run-main-group-1]] - PrintRunnable(4) run() is executed
[Thread[Thread-8,5,run-main-group-1]] - PrintRunnable(6) run() is executed
[Thread[Thread-5,5,run-main-group-1]] - PrintRunnable(3) run() is executed
[Thread[Thread-9,5,run-main-group-1]] - PrintRunnable(7) run() is executed
[Thread[Thread-12,5,run-main-group-1]] - PrintRunnable(10) run() is executed
[Thread[Thread-7,5,run-main-group-1]] - PrintRunnable(5) run() is executed
[Thread[Thread-11,5,run-main-group-1]] - PrintRunnable(9) run() is executed
[Thread[Thread-13,5,run-main-group-1]] - PrintRunnable(11) run() is executed
[Thread[Thread-10,5,run-main-group-1]] - PrintRunnable(8) run() is executed
[Thread[Thread-14,5,run-main-group-1]] - PrintRunnable(12) run() is executed
[success] Total time: 1 s, completed Feb 4, 2018 5:01:20 PM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;For the Executor/ExecutorService example:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; runMain example.executor.Main&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[info] Running example.executor.Main
[Thread[run-main-0,5,run-main-group-0]] - main thread
[Thread[pool-8-thread-1,5,run-main-group-0]] - PrintRunnable(1) run() is executed
[Thread[pool-8-thread-2,5,run-main-group-0]] - PrintRunnable(2) run() is executed
[Thread[pool-8-thread-3,5,run-main-group-0]] - PrintRunnable(3) run() is executed
[Thread[pool-8-thread-1,5,run-main-group-0]] - PrintRunnable(6) run() is executed
[Thread[pool-8-thread-4,5,run-main-group-0]] - PrintRunnable(4) run() is executed
[Thread[pool-8-thread-2,5,run-main-group-0]] - PrintRunnable(7) run() is executed
[Thread[pool-8-thread-3,5,run-main-group-0]] - PrintRunnable(8) run() is executed
[Thread[pool-8-thread-5,5,run-main-group-0]] - PrintRunnable(5) run() is executed
[Thread[pool-8-thread-2,5,run-main-group-0]] - PrintRunnable(11) run() is executed
[Thread[pool-8-thread-4,5,run-main-group-0]] - PrintRunnable(10) run() is executed
[Thread[pool-8-thread-1,5,run-main-group-0]] - PrintRunnable(9) run() is executed
[Thread[pool-8-thread-3,5,run-main-group-0]] - PrintRunnable(12) run() is executed
[success] Total time: 15 s, completed Feb 4, 2018 3:26:02 PM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Then the Future example&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; runMain example.future.Main&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[info] Running example.future.Main
[Thread[run-main-3,5,run-main-group-3]] - main thread
[Thread[scala-execution-context-global-200,5,main]] - printThreadName(1) is executed
[Thread[scala-execution-context-global-199,5,main]] - printThreadName(2) is executed
[Thread[scala-execution-context-global-200,5,main]] - printThreadName(3) is executed
[Thread[scala-execution-context-global-200,5,main]] - printThreadName(4) is executed
[Thread[scala-execution-context-global-200,5,main]] - printThreadName(5) is executed
[Thread[scala-execution-context-global-200,5,main]] - printThreadName(6) is executed
[Thread[scala-execution-context-global-200,5,main]] - printThreadName(7) is executed
[Thread[scala-execution-context-global-200,5,main]] - printThreadName(8) is executed
[Thread[scala-execution-context-global-200,5,main]] - printThreadName(9) is executed
[Thread[scala-execution-context-global-200,5,main]] - printThreadName(10) is executed
[Thread[scala-execution-context-global-200,5,main]] - printThreadName(11) is executed
[Thread[scala-execution-context-global-200,5,main]] - printThreadName(12) is executed
[success] Total time: 3 s, completed Feb 4, 2018 4:40:30 PM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Oracle official doc for Thread at - &lt;a href=&quot;https://docs.oracle.com/javase/tutorial/essential/concurrency/threads.html&quot;&gt;https://docs.oracle.com/javase/tutorial/essential/concurrency/threads.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Javadoc of &lt;code&gt;java.lang.Thraed&lt;/code&gt; at - &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html&quot;&gt;https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Javadoc of &lt;code&gt;java.lang.Runnable&lt;/code&gt; at - &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html&quot;&gt;https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Javadoc of &lt;code&gt;java.util.concurrent.Executor&lt;/code&gt; at - &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executor.html&quot;&gt;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executor.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Javadoc of &lt;code&gt;java.util.concurrent.ExecutorService&lt;/code&gt; at - &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html&quot;&gt;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Scala official documentation of &lt;code&gt;Future&lt;/code&gt; at - &lt;a href=&quot;https://docs.scala-lang.org/overviews/core/futures.html&quot;&gt;https://docs.scala-lang.org/overviews/core/futures.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Scaladoc of &lt;code&gt;scala.concurrent.Future&lt;/code&gt; at - &lt;a href=&quot;https://www.scala-lang.org/api/2.12.4/scala/concurrent/Future.html&quot;&gt;https://www.scala-lang.org/api/2.12.4/scala/concurrent/Future.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Scaladoc of &lt;code&gt;scala.concurrent.Future&lt;/code&gt; at - &lt;a href=&quot;https://www.scala-lang.org/api/2.12.4/scala/concurrent/ExecutionContext.html&quot;&gt;https://www.scala-lang.org/api/2.12.4/scala/concurrent/ExecutionContext.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Akka remoting minimal example part 2 - sender side]]></title><description><![CDATA[Overview You can find the code and instruction to run the example at  GitHub . This is continued from  the previous article , and now we are…]]></description><link>https://richardimaoka.github.io/blog//remote-minimal-sender/</link><guid isPermaLink="false">https://richardimaoka.github.io/blog//remote-minimal-sender/</guid><pubDate>Sat, 03 Feb 2018 16:31:00 GMT</pubDate><content:encoded>&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;You can find the code and instruction to run the example at &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/remote-minimal&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe src=&quot;https://www.youtube.com/embed/TJJUcaJqUeY&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;p&gt;This is continued from &lt;a href=&quot;../remote-minimal-setup&quot;&gt;the previous article&lt;/a&gt;, and now we are going deep into the implementation and behavior of akka remoting on the sender side.&lt;/p&gt;
&lt;h3&gt;Workflow&lt;/h3&gt;
&lt;p&gt;As in the &lt;code&gt;Main&lt;/code&gt; of this example, the sender side sends a message &lt;code&gt;&quot;Hello&quot;&lt;/code&gt; to the receiver side, but in this example, as it uses remoting, the receiver side is referenced by &lt;code&gt;ActorSelection&lt;/code&gt; instead of local &lt;code&gt;ActorRef&lt;/code&gt; unlike the &lt;a href=&quot;../local-minimal-sender&quot;&gt;local sender example&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; selection&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ActorSelection &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
  context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;actorSelection&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

selection &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello!!&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;&lt;code&gt;ActorSelection&lt;/code&gt; has &lt;code&gt;path&lt;/code&gt; inside, which is a URL of the target actor. The components of the &lt;code&gt;path&lt;/code&gt; URL is shown as follows: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt; val path = &quot;akka.tcp://receiverSystem@127.0.0.1:2551/user/receiver&quot;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/path-95b81a72016011952a4d619f7c43c935-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHtqCDQs//EABoQAAICAwAAAAAAAAAAAAAAAAECAxIQESL/2gAIAQEAAQUC62S1Y7Fc/wD/xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAwEBPwFH/8QAFREBAQAAAAAAAAAAAAAAAAAAAAH/2gAIAQIBAT8BV//EABgQAAIDAAAAAAAAAAAAAAAAAAAxICEi/9oACAEBAAY/AhWacP/EABcQAQEBAQAAAAAAAAAAAAAAABEBABD/2gAIAQEAAT8htSSZkWW2RcOf/9oADAMBAAIAAwAAABA7D//EABcRAQEBAQAAAAAAAAAAAAAAABEAASH/2gAIAQMBAT8QOFgwb//EABcRAQEBAQAAAAAAAAAAAAAAABEAASH/2gAIAQIBAT8Qetp1L//EABwQAQEAAgIDAAAAAAAAAAAAAAERACEQMUFxkf/aAAgBAQABPxDSCeHAdMsmi5YOgKop6xLkDd/eP//Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;path&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/path-95b81a72016011952a4d619f7c43c935-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/path-95b81a72016011952a4d619f7c43c935-e8976.jpg 148w,
/blog/static/path-95b81a72016011952a4d619f7c43c935-63df2.jpg 295w,
/blog/static/path-95b81a72016011952a4d619f7c43c935-f8fb9.jpg 590w,
/blog/static/path-95b81a72016011952a4d619f7c43c935-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;You can find more detail about akka’s path &lt;a href=&quot;https://doc.akka.io/docs/akka/current/general/addressing.html?language=scala#actor-references-paths-and-addresses&quot;&gt;in the official documentation&lt;/a&gt;, and &lt;a href=&quot;https://doc.akka.io/docs/akka/current/remoting.html#looking-up-remote-actors&quot;&gt;components of the path&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Now let’s look into the &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/ActorSelection.scala#L265&quot;&gt;&lt;code&gt;!&lt;/code&gt; method&lt;/a&gt; of &lt;code&gt;ActorSelection&lt;/code&gt;,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;trait ScalaActorSelection {
  this: ActorSelection ⇒

  def !(msg: Any)
       (implicit sender: ActorRef = Actor.noSender) = 
    tell(msg, sender)
}&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;and the below &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/ActorSelection.scala#L44L47&quot;&gt;&lt;code&gt;tell&lt;/code&gt; method&lt;/a&gt; called from the above. You can see that the original message &lt;code&gt;&quot;Hello&quot;&lt;/code&gt; is wrapped into &lt;code&gt;ActorSelectionMessage&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;def tell(
  msg: Any,
  sender: ActorRef
): Unit =
  ActorSelection.deliverSelection(
    ...,
    ActorSelectionMessage(msg, ...)
  )&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/actorselectionmessage-8056069cb9493407ef88daac5b0c582c-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB3IYIgsFf/8QAGhAAAgIDAAAAAAAAAAAAAAAAARIAAgMQIf/aAAgBAQABBQLsLLjY13//xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAwEBPwFH/8QAFREBAQAAAAAAAAAAAAAAAAAAAAH/2gAIAQIBAT8BV//EABgQAAIDAAAAAAAAAAAAAAAAAAAxICEi/9oACAEBAAY/AhWacP/EABkQAQEAAwEAAAAAAAAAAAAAABEBABAxQf/aAAgBAQABPyHu+ZcUIZbZFo1//9oADAMBAAIAAwAAABA/D//EABcRAQEBAQAAAAAAAAAAAAAAABEAASH/2gAIAQMBAT8QOWDBv//EABcRAQEBAQAAAAAAAAAAAAAAABEAASH/2gAIAQIBAT8Qetp1L//EABwQAQEAAgIDAAAAAAAAAAAAAAERACEQMUFxkf/aAAgBAQABPxCojTwuaxlJOrlg6AqinrEuQN394//Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;actorselectionmessage&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/actorselectionmessage-8056069cb9493407ef88daac5b0c582c-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/actorselectionmessage-8056069cb9493407ef88daac5b0c582c-e8976.jpg 148w,
/blog/static/actorselectionmessage-8056069cb9493407ef88daac5b0c582c-63df2.jpg 295w,
/blog/static/actorselectionmessage-8056069cb9493407ef88daac5b0c582c-f8fb9.jpg 590w,
/blog/static/actorselectionmessage-8056069cb9493407ef88daac5b0c582c-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Through the &lt;code&gt;deliverSelection&lt;/code&gt; method, &lt;code&gt;ActorSelection&lt;/code&gt; calls &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-remote/src/main/scala/akka/remote/RemoteActorRefProvider.scala#L94&quot;&gt;the following method of &lt;code&gt;RemoteActorRef&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;//remote: RemoteTransport&lt;/span&gt;
  remote&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Option&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sender&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;&lt;code&gt;remote&lt;/code&gt; is an instance of &lt;code&gt;RemoteTransport&lt;/code&gt; which has the following &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-remote/src/main/scala/akka/remote/Remoting.scala#L222L225&quot;&gt;&lt;code&gt;send&lt;/code&gt; method&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; 
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; Some&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;manager&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
    ⇒ manager&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tell&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;  
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;  
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;&lt;code&gt;manager&lt;/code&gt; is ActorRef pointing to an &lt;code&gt;EndPointManager&lt;/code&gt;. (More precisely, there is actually one more actor in-between, but the message is anyway delivered to &lt;code&gt;EndPointManager&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/endpointmanager-2560d7337fa371cd16000085e636fded-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMCBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHqmrJqj//EABoQAAMAAwEAAAAAAAAAAAAAAAECEgMQESL/2gAIAQEAAQUCfL66ZQtMitf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAwEBPwFH/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAEhQf/aAAgBAgEBPwGsS//EABsQAAIBBQAAAAAAAAAAAAAAAAARARASISJh/9oACAEBAAY/ArYOmw1mv//EABoQAAMBAAMAAAAAAAAAAAAAAAABESEQMXH/2gAIAQEAAT8hRujHVNgd7L6M0i4//9oADAMBAAIAAwAAABA3H//EABYRAQEBAAAAAAAAAAAAAAAAAAERAP/aAAgBAwEBPxAsRwQl3//EABcRAQEBAQAAAAAAAAAAAAAAAAERACH/2gAIAQIBAT8QehxVs3//xAAbEAEBAAMAAwAAAAAAAAAAAAABEQAhYRCRwf/aAAgBAQABPxCggdUNY61BIDPuUUb1UayjDrOB68f/2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;endpointmanager&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/endpointmanager-2560d7337fa371cd16000085e636fded-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/endpointmanager-2560d7337fa371cd16000085e636fded-e8976.jpg 148w,
/blog/static/endpointmanager-2560d7337fa371cd16000085e636fded-63df2.jpg 295w,
/blog/static/endpointmanager-2560d7337fa371cd16000085e636fded-f8fb9.jpg 590w,
/blog/static/endpointmanager-2560d7337fa371cd16000085e636fded-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;&lt;code&gt;EndpointManager&lt;/code&gt; manager &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-remote/src/main/scala/akka/remote/Endpoint.scala#L567&quot;&gt;has a buffer inside&lt;/a&gt;, &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;val buffer = new java.util.LinkedList[AnyRef]&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;and upon flushing the buffer, &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-remote/src/main/scala/akka/remote/Endpoint.scala#L673L735&quot;&gt;the &lt;code&gt;sendBufferedMessages&lt;/code&gt; method&lt;/a&gt; is called to efficiently send buffered messages via network. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;def sendBufferedMessages(): Unit = {
  ...
  val ok = writePrioLoop() &amp;&amp; writeLoop(SendBufferBatchSize)
  ...
}&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;The reason for this buffering behavior is, if my understanding is correct, because there is throughput gap between local message-passing (up to &lt;code&gt;EndPointWriter&lt;/code&gt;) and the remote message-passing (after &lt;code&gt;EndPointWriter&lt;/code&gt;), so this buffering behavior will fill in the gap and keep the overall throughput of whole message-passing high.&lt;/p&gt;
&lt;p&gt;There is a following method in &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-remote/src/main/scala/akka/remote/Endpoint.scala#L777L823&quot;&gt;&lt;code&gt;EndpointWriter&lt;/code&gt;&lt;/a&gt;,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;//class EndpointWriter in akka.remote.Endpoint.scala
  def writeSend(s: Send): Boolean = try {
    ...
      
      val pdu: ByteString = codec.constructMessage(
        ..., 
        serializeMessage(s.message), 
        ...)

      ...
      val ok = h.write(pdu)
    ...
  }&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;which performs message serialization, so that the message is converted to a payload which can be passed via network. As akka doc’s &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/serialization.html&quot;&gt;serialization section&lt;/a&gt; says:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;However, messages that have to escape the JVM to reach an actor running on a different host have to undergo some form of serialization (i.e. the objects have to be converted to and from byte arrays).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/serialize-c15d3e21df298bae63af63ee49bfbe24-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAABAv/EABYBAQEBAAAAAAAAAAAAAAAAAAECBP/aAAwDAQACEAMQAAABfwvZwjmSf//EABgQAAMBAQAAAAAAAAAAAAAAAAABAhEQ/9oACAEBAAEFAsY1RKrO/wD/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEv/aAAgBAwEBPwGUv//EABYRAQEBAAAAAAAAAAAAAAAAAAEAA//aAAgBAgEBPwEyJzFv/8QAFhAAAwAAAAAAAAAAAAAAAAAAECAh/9oACAEBAAY/AhU//8QAGhABAQACAwAAAAAAAAAAAAAAAREAICFRYf/aAAgBAQABPyHwcHUr0TEcDdP/2gAMAwEAAgADAAAAEKs//8QAFhEAAwAAAAAAAAAAAAAAAAAAARAR/9oACAEDAQE/EICf/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAgEBPxADuzhOX//EABsQAQACAgMAAAAAAAAAAAAAABEAARAhQVHx/9oACAEBAAE/EPGuaKJwCIa66uFKZ//Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;serialize&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/serialize-c15d3e21df298bae63af63ee49bfbe24-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/serialize-c15d3e21df298bae63af63ee49bfbe24-e8976.jpg 148w,
/blog/static/serialize-c15d3e21df298bae63af63ee49bfbe24-63df2.jpg 295w,
/blog/static/serialize-c15d3e21df298bae63af63ee49bfbe24-f8fb9.jpg 590w,
/blog/static/serialize-c15d3e21df298bae63af63ee49bfbe24-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;serialization converts a JVM object into &lt;code&gt;Array[Byte]&lt;/code&gt;. The above &lt;code&gt;writeSend&lt;/code&gt; converts &lt;code&gt;Array[Byte]&lt;/code&gt; further into &lt;code&gt;ByteString&lt;/code&gt; by &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/util/ByteString.scala#L25&quot;&gt;its &lt;code&gt;apply&lt;/code&gt; method&lt;/a&gt;. &lt;code&gt;ByteString&lt;/code&gt; is extensively used in Akka when payload needs to be send via network.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;object ByteString {

  /**
   * Creates a new ByteString by copying a byte array.
   */
  def apply(bytes: Array[Byte]): ByteString = CompactByteString(bytes)&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Now it comes down to the point between the application (akka) layer and the network layer. The &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-remote/src/main/scala/akka/remote/transport/netty/TcpSupport.scala#L86L103&quot;&gt;&lt;code&gt;write&lt;/code&gt; method&lt;/a&gt; of &lt;code&gt;TcpAssociationHandle&lt;/code&gt; has &lt;code&gt;Channel&lt;/code&gt; class instance where the &lt;code&gt;Channel&lt;/code&gt; class is defined in the &lt;code&gt;Netty&lt;/code&gt; library.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;//Channel is a class in netty, so from here the work is passed to netty
private[remote] class TcpAssociationHandle(
  val localAddress:    Address,
  val remoteAddress:   Address,
  val transport:       NettyTransport,
  private val channel: Channel)
  extends AssociationHandle {
  import transport.executionContext

  override val readHandlerPromise: Promise[HandleEventListener] = Promise()

  override def write(payload: ByteString): Boolean =
    if (channel.isWritable &amp;&amp; channel.isOpen) {
      channel.write(ChannelBuffers.wrappedBuffer(payload.asByteBuffer))
      true
    } else false&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMBBP/EABUBAQEAAAAAAAAAAAAAAAAAAAIE/9oADAMBAAIQAxAAAAHuWwxxXJ//xAAYEAADAQEAAAAAAAAAAAAAAAAAAhEBMf/aAAgBAQABBQI2xbFRVGM5/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAECEf/aAAgBAwEBPwGZRh//xAAYEQADAQEAAAAAAAAAAAAAAAAAARECA//aAAgBAgEBPwFc4PNZ/8QAFxAAAwEAAAAAAAAAAAAAAAAAABAhAf/aAAgBAQAGPwJUmP8A/8QAGxABAQABBQAAAAAAAAAAAAAAAREAECExgZH/2gAIAQEAAT8h6fMlQNwvabiCyvOq/9oADAMBAAIAAwAAABCLD//EABYRAQEBAAAAAAAAAAAAAAAAAAEQIf/aAAgBAwEBPxADk//EABcRAQEBAQAAAAAAAAAAAAAAAAEAETH/2gAIAQIBAT8QFbCjy//EAB4QAQADAAAHAAAAAAAAAAAAAAEAESExQVFhcZHw/9oACAEBAAE/EBVQVOigWgjCmAk1u/CWuPKXfrZgPM0Vv3P/2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;netty&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-e8976.jpg 148w,
/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-63df2.jpg 295w,
/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-f8fb9.jpg 590w,
/blog/static/netty-96343e72e3f9855be8e66c37ed135e02-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;So this lets netty take care of payload transfer to a remote JVM.&lt;/p&gt;
&lt;h2&gt;Instruction to run the example, and output&lt;/h2&gt;
&lt;p&gt;As this example uses &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/remoting.html&quot;&gt;Akka remoting&lt;/a&gt; to send a message,
you need to run two JVMs for the receiver and sender of the application respectively.&lt;/p&gt;
&lt;p&gt;Firstly, run the receiver side with the &lt;code&gt;receiver&lt;/code&gt; argument supplied to &lt;code&gt;Main&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; git clone https://github.com/richardimaoka/resources.git
&gt; cd resources
&gt; cd remote-minimal
&gt; sbt
&gt; runMain example.Main receiver&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;You’ll get output like below, then it waits until the message is sent from the sender.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; runMain example.Main receiver
[info] Running example.Main receiver
Program args:
receiver
running startMessageReceiver()
[INFO] [02/03/2018 13:36:58.281] [run-main-0] [akka.remote.Remoting] Starting remoting
[INFO] [02/03/2018 13:36:58.462] [run-main-0] [akka.remote.Remoting] Remoting started; listening on addresses :[akka.tcp://receiverSystem@127.0.0.1:2551]
[INFO] [02/03/2018 13:36:58.464] [run-main-0] [akka.remote.Remoting] Remoting now listens on addresses: [akka.tcp://receiverSystem@127.0.0.1:2551]
provider = remote
listening at port = 2551
started a receiver actor = Actor[akka://receiverSystem/user/receiver#-603875191]&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Then in the same directory, run the same &lt;code&gt;Main&lt;/code&gt; with &lt;code&gt;sender&lt;/code&gt; as the argument&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; sbt
&gt; runMain example.Main sender&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;this is the sender side output:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[info] Running example.Main sender
Program args:
sender
running startMessageSender()
[INFO] [02/03/2018 13:37:16.215] [run-main-0] [akka.remote.Remoting] Starting remoting
[INFO] [02/03/2018 13:37:16.427] [run-main-0] [akka.remote.Remoting] Remoting started; listening on addresses :[akka.tcp://senderSystem@127.0.0.1:2552]
[INFO] [02/03/2018 13:37:16.432] [run-main-0] [akka.remote.Remoting] Remoting now listens on addresses: [akka.tcp://senderSystem@127.0.0.1:2552]
provider = remote
listening at port = 2552
sending a message to akka.tcp://receiverSystem@127.0.0.1:2551/user/receiver
[INFO] [02/03/2018 13:37:19.533] [senderSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://senderSystem@127.0.0.1:2552/system/remoting-terminator] Shutting down remote daemon.
[INFO] [02/03/2018 13:37:19.537] [senderSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://senderSystem@127.0.0.1:2552/system/remoting-terminator] Remote daemon shut down; proceeding with flushing remote transports.
[INFO] [02/03/2018 13:37:19.577] [senderSystem-akka.actor.default-dispatcher-4] [akka.remote.Remoting] Remoting shut down
[INFO] [02/03/2018 13:37:19.577] [senderSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://senderSystem@127.0.0.1:2552/system/remoting-terminator] Remoting shut down.
[success] Total time: 5 s, completed Feb 3, 2018 1:37:19 PM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;then you see the receiver output as follows:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;EchoActor: received message = Hello!!&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;and immediately after that, the receiver side shows this error, which can be ignored.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[ERROR] [02/03/2018 13:37:19.572] [receiverSystem-akka.remote.default-remote-dispatcher-15] [akka.tcp://receiverSystem@127.0.0.1:2551/system/endpointManager/reliableEndpointWriter-akka.tcp%3A%2F%2FsenderSystem%40127.0.0.1%3A2552-0/endpointWriter] AssociationError [akka.tcp://receiverSystem@127.0.0.1:2551] &lt;- [akka.tcp://senderSystem@127.0.0.1:2552]: Error [Shut down address: akka.tcp://senderSystem@127.0.0.1:2552] [
akka.remote.ShutDownAssociation: Shut down address: akka.tcp://senderSystem@127.0.0.1:2552
Caused by: akka.remote.transport.Transport$InvalidAssociationException: The remote system terminated the association because it is shutting down.
]&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;As explained in &lt;a href=&quot;https://groups.google.com/forum/#!topic/akka-user/eerWNwRQ7o0&quot;&gt;this thrad in akka-user&lt;/a&gt; mailing list, the error happens specifically when you launch a process like this example from sbt, but when you compile your application and run it witout sbt, then the error disappears.&lt;/p&gt;
&lt;p&gt;Once everything is done, press the enter key on the receiver side’s console and you get this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[INFO] [02/03/2018 13:38:05.942] [receiverSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://receiverSystem@127.0.0.1:2551/system/remoting-terminator] Shutting down remote daemon.
[INFO] [02/03/2018 13:38:05.944] [receiverSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://receiverSystem@127.0.0.1:2551/system/remoting-terminator] Remote daemon shut down; proceeding with flushing remote transports.
[INFO] [02/03/2018 13:38:05.960] [receiverSystem-akka.actor.default-dispatcher-3] [akka.remote.Remoting] Remoting shut down
[INFO] [02/03/2018 13:38:05.960] [receiverSystem-akka.remote.default-remote-dispatcher-6] [akka.tcp://receiverSystem@127.0.0.1:2551/system/remoting-terminator] Remoting shut down.&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Official documentation of Akka remoting at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/remoting.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/remoting.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Official documentation of Akka serialization at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/serialization.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/serialization.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Netty documentation at &lt;a href=&quot;https://netty.io/&quot;&gt;https://netty.io/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Akka remoting minimal example part 1 - setup]]></title><description><![CDATA[Overview You can find the code and instruction to run the example at  GitHub . The next article  explains how this remoting example works on…]]></description><link>https://richardimaoka.github.io/blog//remote-minimal-setup/</link><guid isPermaLink="false">https://richardimaoka.github.io/blog//remote-minimal-setup/</guid><pubDate>Fri, 02 Feb 2018 16:31:00 GMT</pubDate><content:encoded>&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;You can find the code and instruction to run the example at &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/remote-minimal&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe src=&quot;https://www.youtube.com/embed/YYGQYSpoBhE&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;../remote-minimal-sender&quot;&gt;The next article&lt;/a&gt; explains how this remoting example works on the sender side.&lt;/p&gt;
&lt;h2&gt;Instruction to run the example, and output&lt;/h2&gt;
&lt;p&gt;As this example uses &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/remoting.html&quot;&gt;Akka remoting&lt;/a&gt; to send a message,
you need to run two JVMs for the receiver and sender of the application respectively.&lt;/p&gt;
&lt;p&gt;Firstly, run the receiver side with the &lt;code&gt;receiver&lt;/code&gt; argument supplied to &lt;code&gt;Main&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; git clone https://github.com/richardimaoka/resources.git
&gt; cd resources
&gt; cd remote-minimal
&gt; sbt
&gt; runMain example.Main receiver&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;You’ll get output like below, then it waits until the message is sent from the sender.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; runMain example.Main receiver
[info] Running example.Main receiver
Program args:
receiver
running startMessageReceiver()
[INFO] [02/03/2018 13:36:58.281] [run-main-0] [akka.remote.Remoting] Starting remoting
[INFO] [02/03/2018 13:36:58.462] [run-main-0] [akka.remote.Remoting] Remoting started; listening on addresses :[akka.tcp://receiverSystem@127.0.0.1:2551]
[INFO] [02/03/2018 13:36:58.464] [run-main-0] [akka.remote.Remoting] Remoting now listens on addresses: [akka.tcp://receiverSystem@127.0.0.1:2551]
provider = remote
listening at port = 2551
started a receiver actor = Actor[akka://receiverSystem/user/receiver#-603875191]&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Then in the same directory, run the same &lt;code&gt;Main&lt;/code&gt; with &lt;code&gt;sender&lt;/code&gt; as the argument&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; sbt
&gt; runMain example.Main sender&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;this is the sender side output:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[info] Running example.Main sender
Program args:
sender
running startMessageSender()
[INFO] [02/03/2018 13:37:16.215] [run-main-0] [akka.remote.Remoting] Starting remoting
[INFO] [02/03/2018 13:37:16.427] [run-main-0] [akka.remote.Remoting] Remoting started; listening on addresses :[akka.tcp://senderSystem@127.0.0.1:2552]
[INFO] [02/03/2018 13:37:16.432] [run-main-0] [akka.remote.Remoting] Remoting now listens on addresses: [akka.tcp://senderSystem@127.0.0.1:2552]
provider = remote
listening at port = 2552
sending a message to akka.tcp://receiverSystem@127.0.0.1:2551/user/receiver
[INFO] [02/03/2018 13:37:19.533] [senderSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://senderSystem@127.0.0.1:2552/system/remoting-terminator] Shutting down remote daemon.
[INFO] [02/03/2018 13:37:19.537] [senderSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://senderSystem@127.0.0.1:2552/system/remoting-terminator] Remote daemon shut down; proceeding with flushing remote transports.
[INFO] [02/03/2018 13:37:19.577] [senderSystem-akka.actor.default-dispatcher-4] [akka.remote.Remoting] Remoting shut down
[INFO] [02/03/2018 13:37:19.577] [senderSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://senderSystem@127.0.0.1:2552/system/remoting-terminator] Remoting shut down.
[success] Total time: 5 s, completed Feb 3, 2018 1:37:19 PM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;then you see the receiver output as follows:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;EchoActor: received message = Hello!!&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;and immediately after that, the receiver side shows this error, which can be ignored.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[ERROR] [02/03/2018 13:37:19.572] [receiverSystem-akka.remote.default-remote-dispatcher-15] [akka.tcp://receiverSystem@127.0.0.1:2551/system/endpointManager/reliableEndpointWriter-akka.tcp%3A%2F%2FsenderSystem%40127.0.0.1%3A2552-0/endpointWriter] AssociationError [akka.tcp://receiverSystem@127.0.0.1:2551] &lt;- [akka.tcp://senderSystem@127.0.0.1:2552]: Error [Shut down address: akka.tcp://senderSystem@127.0.0.1:2552] [
akka.remote.ShutDownAssociation: Shut down address: akka.tcp://senderSystem@127.0.0.1:2552
Caused by: akka.remote.transport.Transport$InvalidAssociationException: The remote system terminated the association because it is shutting down.
]&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;As explained in &lt;a href=&quot;https://groups.google.com/forum/#!topic/akka-user/eerWNwRQ7o0&quot;&gt;this thrad in akka-user&lt;/a&gt; mailing list, the error happens specifically when you launch a process like this example from sbt, but when you compile your application and run it witout sbt, then the error disappears.&lt;/p&gt;
&lt;p&gt;Once everything is done, press the enter key on the receiver side’s console and you get this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[INFO] [02/03/2018 13:38:05.942] [receiverSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://receiverSystem@127.0.0.1:2551/system/remoting-terminator] Shutting down remote daemon.
[INFO] [02/03/2018 13:38:05.944] [receiverSystem-akka.remote.default-remote-dispatcher-5] [akka.tcp://receiverSystem@127.0.0.1:2551/system/remoting-terminator] Remote daemon shut down; proceeding with flushing remote transports.
[INFO] [02/03/2018 13:38:05.960] [receiverSystem-akka.actor.default-dispatcher-3] [akka.remote.Remoting] Remoting shut down
[INFO] [02/03/2018 13:38:05.960] [receiverSystem-akka.remote.default-remote-dispatcher-6] [akka.tcp://receiverSystem@127.0.0.1:2551/system/remoting-terminator] Remoting shut down.&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Official documentation at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/remoting.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/remoting.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Local Actor workflow part 2 - Receiver side]]></title><description><![CDATA[Overview You can find the code and instruction to run the example at  GitHub . This is continued from the previous article,  Local Actor…]]></description><link>https://richardimaoka.github.io/blog//local-minimal-receiver/</link><guid isPermaLink="false">https://richardimaoka.github.io/blog//local-minimal-receiver/</guid><pubDate>Mon, 29 Jan 2018 16:31:08 GMT</pubDate><content:encoded>&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;You can find the code and instruction to run the example at &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/local-minimal&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe src=&quot;https://www.youtube.com/embed/LbuLAtN20HA&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;p&gt;This is continued from the previous article, &lt;a href=&quot;../local-minimal-sender&quot;&gt;Local Actor workflow part 1 - Sender side&lt;/a&gt;. I would recommend you to read that article too.&lt;/p&gt;
&lt;p&gt;Also, later I am going to write the remote versions of articles to illustrate the message-sending/receiving behavior of Akka Actor when sending across different JVMs.&lt;/p&gt;
&lt;h2&gt;Workflow&lt;/h2&gt;
&lt;p&gt;As in bottom of the previous &lt;a href=&quot;../local-minimal-sender&quot;&gt;Local Actor workflow part 1 - Sender side&lt;/a&gt; article, the below  &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Dispatcher.scala#L115&quot;&gt;registerForExecution&lt;/a&gt; method will let Java’s &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html&quot;&gt;&lt;code&gt;ExecutorService&lt;/code&gt;&lt;/a&gt; process &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Mailbox.scala#L56L57&quot;&gt;&lt;code&gt;Mailbox&lt;/code&gt;&lt;/a&gt; , which is defined as &lt;code&gt;ForkJoinTask&lt;/code&gt;, to be executed on a different thread.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; registerForExecution&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mbox&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Mailbox&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Boolean&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  executorService execute mbox
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; Mailbox&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; messageQueue&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; MessageQueue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; ForkJoinTask&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
  &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; SystemMessageQueue 
  &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; Runnable &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;When &lt;code&gt;ExecutorService&lt;/code&gt; executes the &lt;code&gt;Mailbox&lt;/code&gt; as &lt;code&gt;ForkJoinTask&lt;/code&gt;, then the following &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/java/akka/dispatch/forkjoin/ForkJoinWorkerThread.java#L103&quot;&gt;&lt;code&gt;run&lt;/code&gt; method of &lt;code&gt;ForkJoinWorkerThread&lt;/code&gt;&lt;/a&gt; is called:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-java&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;(Somehow a copy of ForkJoinWorkerThread from Java’s standard library is in akka’s source code … not sure why)&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;run&lt;/code&gt; method above runs the &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Mailbox.scala#L250&quot;&gt;following method of &lt;code&gt;Mailbox&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@tailrec&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; processMailbox&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// def dequeue(): Envelope = messageQueue.dequeue()&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; next &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; dequeue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  actor invoke next
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  processMailbox&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;By &lt;code&gt;dequeue&lt;/code&gt;-ing an &lt;code&gt;Envelope&lt;/code&gt;, &lt;code&gt;Mailbox&lt;/code&gt; calls the &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/ActorCell.scala#L488&quot;&gt;&lt;code&gt;invoke&lt;/code&gt; method of &lt;code&gt;ActorCell&lt;/code&gt;&lt;/a&gt;, &lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/processmailbox-94910b51aebb7b417483b0a787ba8151-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHWddSMJB//xAAZEAADAAMAAAAAAAAAAAAAAAAAAQIQEzH/2gAIAQEAAQUCl3spi5hH/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8BJ//EABYRAQEBAAAAAAAAAAAAAAAAAAEQEf/aAAgBAgEBPwFdn//EABcQAQADAAAAAAAAAAAAAAAAAAERICL/2gAIAQEABj8CZM2//8QAGRAAAgMBAAAAAAAAAAAAAAAAAAERITFR/9oACAEBAAE/IUlO4IFVvg8h4SzCP//aAAwDAQACAAMAAAAQQA//xAAXEQADAQAAAAAAAAAAAAAAAAABEBEx/9oACAEDAQE/EAmmr//EABYRAQEBAAAAAAAAAAAAAAAAABEQMf/aAAgBAgEBPxBGE//EABwQAAICAgMAAAAAAAAAAAAAAAERACFBgVFxwf/aAAgBAQABPxAI4Da9XmUwGlAUTEB1n2ULqOJZxCZjxP/Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;processmailbox&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/processmailbox-94910b51aebb7b417483b0a787ba8151-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/processmailbox-94910b51aebb7b417483b0a787ba8151-e8976.jpg 148w,
/blog/static/processmailbox-94910b51aebb7b417483b0a787ba8151-63df2.jpg 295w,
/blog/static/processmailbox-94910b51aebb7b417483b0a787ba8151-f8fb9.jpg 590w,
/blog/static/processmailbox-94910b51aebb7b417483b0a787ba8151-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; invoke&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;messageHandle&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Envelope&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  receiveMessage&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;msg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;which unpacks the message from &lt;code&gt;Envelope&lt;/code&gt; then calls &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/ActorCell.scala#L527&quot;&gt;&lt;code&gt;receiveMessage&lt;/code&gt; of &lt;code&gt;ActorCell&lt;/code&gt;&lt;/a&gt;,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token comment&quot;&gt;// def actor: Actor = ... in ActorCell&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; receiveMessage&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;msg&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
  actor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;aroundReceive&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;behaviorStack&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;head&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/receivemessage-e0b1f55a0e7451ee216a1da37f8b2e9c-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHVfdSMJB//xAAaEAACAgMAAAAAAAAAAAAAAAAAAQIREyEx/9oACAEBAAEFAlKeRvS4WI//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPwEn/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/AV2f/8QAFxABAAMAAAAAAAAAAAAAAAAAAREgIf/aAAgBAQAGPwJky3//xAAaEAACAwEBAAAAAAAAAAAAAAAAARExUSFB/9oACAEBAAE/IVEuyeFdweQ6JaUR/9oADAMBAAIAAwAAABDQD//EABcRAAMBAAAAAAAAAAAAAAAAAAEQETH/2gAIAQMBAT8QCDav/8QAFREBAQAAAAAAAAAAAAAAAAAAERD/2gAIAQIBAT8QQhP/xAAdEAACAgEFAAAAAAAAAAAAAAABEQAhQVFhcYHB/9oACAEBAAE/EBUwt7W15hwxSyQoxAes+yhcQFJtCZjpP//Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;receivemessage&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/receivemessage-e0b1f55a0e7451ee216a1da37f8b2e9c-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/receivemessage-e0b1f55a0e7451ee216a1da37f8b2e9c-e8976.jpg 148w,
/blog/static/receivemessage-e0b1f55a0e7451ee216a1da37f8b2e9c-63df2.jpg 295w,
/blog/static/receivemessage-e0b1f55a0e7451ee216a1da37f8b2e9c-f8fb9.jpg 590w,
/blog/static/receivemessage-e0b1f55a0e7451ee216a1da37f8b2e9c-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Here, &lt;code&gt;Actor&lt;/code&gt; has an important method called &lt;code&gt;aroundReceive&lt;/code&gt;, &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; aroundReceive&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;receive&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Actor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Receive&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    receive&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;applyOrElse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;msg&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Actor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notHandledFun&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asInstanceOf&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;AnyRef&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; eq Actor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;NotHandled
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    unhandled&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;msg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;which, as the name suggests, wraps around &lt;code&gt;Actor&lt;/code&gt;’s &lt;code&gt;receive&lt;/code&gt; method. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; MessageReceiver &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; Actor &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; receive &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; s&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;=&gt;&lt;/span&gt;
      EchoActor&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; received message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; $s&quot;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/receive-9bf14710a79d18dd691d0599f5f6ee4d-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHWvmkQwf/EABoQAQABBQAAAAAAAAAAAAAAAAECAxATITH/2gAIAQEAAQUCi1MjoOX/AP/EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/ASf/xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8BXZ//xAAWEAEBAQAAAAAAAAAAAAAAAAABICL/2gAIAQEABj8CRM1//8QAGRABAAIDAAAAAAAAAAAAAAAAAQARIEFR/9oACAEBAAE/IUVDRjejHeD/2gAMAwEAAgADAAAAEBDP/8QAFxEBAAMAAAAAAAAAAAAAAAAAARARMf/aAAgBAwEBPxAUbH//xAAWEQEBAQAAAAAAAAAAAAAAAAAREDH/2gAIAQIBAT8QRhP/xAAdEAACAQQDAAAAAAAAAAAAAAABEQAgIUFRgaHB/9oACAEBAAE/EDCBNnS3HEAuAQs4gPGfaP/Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;receive&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/receive-9bf14710a79d18dd691d0599f5f6ee4d-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/receive-9bf14710a79d18dd691d0599f5f6ee4d-e8976.jpg 148w,
/blog/static/receive-9bf14710a79d18dd691d0599f5f6ee4d-63df2.jpg 295w,
/blog/static/receive-9bf14710a79d18dd691d0599f5f6ee4d-f8fb9.jpg 590w,
/blog/static/receive-9bf14710a79d18dd691d0599f5f6ee4d-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;In &lt;code&gt;aroundReceive&lt;/code&gt; you can see &lt;code&gt;receive.applyOrElse&lt;/code&gt; is called, and if there is no match in &lt;code&gt;receive&lt;/code&gt;’s patter-match, it will call &lt;code&gt;unhandled&lt;/code&gt; of &lt;code&gt;Actor&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Up to here, we have pretty much covered the receiver side of the behavior in actor’s message passing. Next up, I will go through how this changes when sending to a remote JVM.&lt;/p&gt;
&lt;h2&gt;Instruction to run the example&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; git clone https://github.com/richardimaoka/resources.git
&gt; cd resources
&gt; cd local-minimal
&gt; sbt
&gt; runMain example.Main&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;Output&lt;/h2&gt;
&lt;p&gt;Some &lt;code&gt;println&lt;/code&gt; calls are inserted in the &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/local-minimal&quot;&gt;complete example at GitHub&lt;/a&gt; to illustrate the behavior.&lt;/p&gt;
&lt;p&gt;Thread names are shown as [exampleSystem-akka.actor.default-dispatcher-3] and […-4].&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[info] Running example.Main
provider = local
[exampleSystem-akka.actor.default-dispatcher-5] sending message Hello World to Actor[akka://exampleSystem/user/receiver#-846959521]
[exampleSystem-akka.actor.default-dispatcher-5] sending message Hello Universe to Actor[akka://exampleSystem/user/receiver#-846959521]
[exampleSystem-akka.actor.default-dispatcher-2] EchoActor: received message = Hello World
[exampleSystem-akka.actor.default-dispatcher-5] sending message Hello Galaxy to Actor[akka://exampleSystem/user/receiver#-846959521]
[exampleSystem-akka.actor.default-dispatcher-2] EchoActor: received message = Hello Universe
[exampleSystem-akka.actor.default-dispatcher-2] EchoActor: received message = Hello Galaxy
[success] Total time: 7 s, completed Jan 30, 2018 6:16:46 AM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Official documentation of Akka Actor at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/actors.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/actors.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Official documentation of Akka Dispatcher at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/dispatchers.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/dispatchers.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Official documentation of Akka lifecycle at &lt;a href=&quot;https://doc.akka.io/docs/akka/current/actors.html$actor-lifecycle&quot;&gt;https://doc.akka.io/docs/akka/current/actors.html$actor-lifecycle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Official documentation of Akka Mailbox at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/mailboxes.html?language=scala#mailboxes&quot;&gt;https://doc.akka.io/docs/akka/2.5/mailboxes.html?language=scala#mailboxes&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Official documentation of Akka location transparency at &lt;a href=&quot;https://doc.akka.io/docs/akka/current/general/remoting.html#location-transparency&quot;&gt;https://doc.akka.io/docs/akka/current/general/remoting.html#location-transparency&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Oracle’s documentation about Fork/Join at &lt;a href=&quot;https://docs.oracle.com/javase/tutorial/essential/concurrency/forkjoin.html&quot;&gt;https://docs.oracle.com/javase/tutorial/essential/concurrency/forkjoin.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ExecutorService Javadoc at &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html&quot;&gt;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Local Actor workflow part 1 - Sender side]]></title><description><![CDATA[Overview You can find the code and instruction to run the example at  GitHub . This is about how Akka sends a message from one Actor to…]]></description><link>https://richardimaoka.github.io/blog//local-minimal-sender/</link><guid isPermaLink="false">https://richardimaoka.github.io/blog//local-minimal-sender/</guid><pubDate>Mon, 29 Jan 2018 16:31:00 GMT</pubDate><content:encoded>&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;You can find the code and instruction to run the example at &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/local-minimal&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe src=&quot;https://www.youtube.com/embed/hQJkN4zXTyo&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;p&gt;This is about how Akka sends a message from one Actor to another &lt;strong&gt;locally&lt;/strong&gt; (i.e. within the same JVM). As in the &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/serialization.html?language=scala&quot;&gt;&lt;code&gt;Serialization&lt;/code&gt; part&lt;/a&gt; of the official doc:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The messages that Akka actors send to each other are JVM objects (e.g. instances of Scala case classes). Message passing between actors that live on the same JVM is straightforward. It is simply done via reference passing. &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If you are interested in the remote behavior when sending messages to remote JVM, I will write remote versions of articles soon so please refer to them.&lt;/p&gt;
&lt;h2&gt;Workflow&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/richardimaoka/resources/blob/master/local-minimal/src/main/scala/example/Main.scala#L14L24&quot;&gt;&lt;code&gt;MessageSender&lt;/code&gt;&lt;/a&gt; sends messages “Hello World”, “Hello Universe” and “Hello Galaxy” to the &lt;code&gt;messageReceiver&lt;/code&gt; actor.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; MessageSender&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;messageReceiver&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ActorRef&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; Actor &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  
  &lt;span class=&quot;token keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; preStart&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; messages &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;token string&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token string&quot;&gt;&quot;Hello Universe&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token string&quot;&gt;&quot;Hello Galaxy&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;msg &lt;span class=&quot;token keyword&quot;&gt;&amp;lt;-&lt;/span&gt; messages&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      messageReceiver &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; msg
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;The &lt;code&gt;preStart&lt;/code&gt; method is a &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/guide/tutorial_1.html?language=scala#the-actor-lifecycle&quot;&gt;lifecycle method&lt;/a&gt; provided by Akka Actor.&lt;/p&gt;
&lt;p&gt;The below is what’s inside the main method, which initializes the receiver and the sender.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; system &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ActorSystem&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;exampleSystem&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; receiver &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; system&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;actorOf&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  Props&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;MessageReceiver&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;receiver&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// sender&lt;/span&gt;
system&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;actorOf&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  MessageSender&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;receiver&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
  &lt;span class=&quot;token string&quot;&gt;&quot;sender&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;As in the &lt;code&gt;preStart&lt;/code&gt; method of &lt;code&gt;MessageSender&lt;/code&gt;, the first message to be sent is,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;messageReceiver &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/message-4093dc1854d0d519ddf1fc745d96b789-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB12zLEFgP/8QAGhABAAEFAAAAAAAAAAAAAAAAAgEDEBITMf/aAAgBAQABBQIy9i5Tyk3/AP/EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAwEBPwHEf//EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAgEBPwHVf//EABkQAAIDAQAAAAAAAAAAAAAAAAABESIxIP/aAAgBAQAGPwJyqjjS28f/xAAZEAACAwEAAAAAAAAAAAAAAAABEQAQIWH/2gAIAQEAAT8hNHyQjlaZDdFNSr//2gAMAwEAAgADAAAAEGsP/8QAFhEBAQEAAAAAAAAAAAAAAAAAEQEA/9oACAEDAQE/EIIOgg7/xAAWEQEBAQAAAAAAAAAAAAAAAAABEQD/2gAIAQIBAT8QQtmVbN//xAAeEAEAAgIBBQAAAAAAAAAAAAABABEhYRAxQXGBkf/aAAgBAQABPxBggLs3Ws94fHKRuXB2AtRTxEHrfplN/eP/2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;message&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/message-4093dc1854d0d519ddf1fc745d96b789-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/message-4093dc1854d0d519ddf1fc745d96b789-e8976.jpg 148w,
/blog/static/message-4093dc1854d0d519ddf1fc745d96b789-63df2.jpg 295w,
/blog/static/message-4093dc1854d0d519ddf1fc745d96b789-f8fb9.jpg 590w,
/blog/static/message-4093dc1854d0d519ddf1fc745d96b789-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;where the &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/ActorRef.scala#L400&quot;&gt;&lt;code&gt;!&lt;/code&gt; method&lt;/a&gt; is a method of &lt;code&gt;LocalActorRef&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;implicit&lt;/span&gt; sender&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ActorRef &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Actor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;noSender&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
    actorCell&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sendMessage&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sender&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Above &lt;code&gt;actorCell&lt;/code&gt; is an instance of &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/ActorCell.scala#L370&quot;&gt;&lt;code&gt;ActorCell&lt;/code&gt;&lt;/a&gt;, which implements &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/ActorCell.scala#L220&quot;&gt;&lt;code&gt;Cell&lt;/code&gt; trait&lt;/a&gt;, and the &lt;code&gt;Cell&lt;/code&gt; trait has the following &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/ActorCell.scala#L290L291&quot;&gt;&lt;code&gt;sendMessage&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; sendMessage&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  message&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
  sender&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ActorRef
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
  sendMessage&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Envelope&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sender&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; system&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Here you see an &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/AbstractDispatcher.scala#L23&quot;&gt;&lt;code&gt;Envelope&lt;/code&gt;&lt;/a&gt; which encapsulates &lt;code&gt;message&lt;/code&gt; and &lt;code&gt;sender&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/envelope-91cfa7f809e99172f6902691b880c231-85b28.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 298px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 40.939597315436245%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB2rCgf//EABYQAAMAAAAAAAAAAAAAAAAAAAECEP/aAAgBAQABBQItf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAEQMZH/2gAIAQEABj8Chx//xAAYEAEAAwEAAAAAAAAAAAAAAAABABFx4f/aAAgBAQABPyFLQ0gGuzZ//9oADAMBAAIAAwAAABDzz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQEAAgMBAAAAAAAAAAAAAAERACExUWHx/9oACAEBAAE/ENQGJCnGF26IfGFmgPjc/9k=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;envelope&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/envelope-91cfa7f809e99172f6902691b880c231-85b28.jpg&quot;
        srcset=&quot;/blog/static/envelope-91cfa7f809e99172f6902691b880c231-83678.jpg 148w,
/blog/static/envelope-91cfa7f809e99172f6902691b880c231-04048.jpg 295w,
/blog/static/envelope-91cfa7f809e99172f6902691b880c231-85b28.jpg 298w&quot;
        sizes=&quot;(max-width: 298px) 100vw, 298px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; Envelope&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; message&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
  &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; sender&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ActorRef
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;To illustrate the workflow so far up to the &lt;code&gt;sendMessage&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/sendMessage-97c0ac69e59e5122c722926a1e80a4e4-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB24uEQWCv/8QAGxAAAQQDAAAAAAAAAAAAAAAAAQACAxIQESH/2gAIAQEAAQUC6tmsdi3P/8QAFREBAQAAAAAAAAAAAAAAAAAAAAH/2gAIAQMBAT8BR//EABURAQEAAAAAAAAAAAAAAAAAAAAB/9oACAECAQE/AVf/xAAYEAACAwAAAAAAAAAAAAAAAAAAASAiUf/aAAgBAQAGPwIelof/xAAaEAADAQADAAAAAAAAAAAAAAAAAREhEDFh/9oACAEBAAE/IW9wfX5Wej2rHSUnH//aAAwDAQACAAMAAAAQ7w//xAAXEQEBAQEAAAAAAAAAAAAAAAARAAEh/9oACAEDAQE/EDlgwb//xAAXEQEBAQEAAAAAAAAAAAAAAAARAAEh/9oACAECAQE/EHradS//xAAeEAACAQMFAAAAAAAAAAAAAAABEQAQITFBYXGBkf/aAAgBAQABPxBlSWLSxNIGzRwbSZIJHEIZPoxN/af/2Q==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;sendMessage&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/sendMessage-97c0ac69e59e5122c722926a1e80a4e4-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/sendMessage-97c0ac69e59e5122c722926a1e80a4e4-e8976.jpg 148w,
/blog/static/sendMessage-97c0ac69e59e5122c722926a1e80a4e4-63df2.jpg 295w,
/blog/static/sendMessage-97c0ac69e59e5122c722926a1e80a4e4-f8fb9.jpg 590w,
/blog/static/sendMessage-97c0ac69e59e5122c722926a1e80a4e4-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;The &lt;code&gt;sendMessage&lt;/code&gt; method of the &lt;code&gt;Cell&lt;/code&gt; trait (&lt;code&gt;ActorCell&lt;/code&gt;) calls the &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/actor/dungeon/Dispatch.scala#L136&quot;&gt;&lt;code&gt;sendMessage&lt;/code&gt; method&lt;/a&gt; of the &lt;code&gt;Dispatch&lt;/code&gt; trait.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; sendMessage&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;msg&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Envelope&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    dispatcher&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dispatch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;(&lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/dispatchers.html?language=scala&quot;&gt;The concept of &lt;code&gt;Dispatcher&lt;/code&gt;&lt;/a&gt; might be unfamiliar to you and it is probably difficult to understand. I will write another article later to illustrate &lt;code&gt;Dispatcher&lt;/code&gt; in more detail, but for now, you can assume dispatcher is, as the meaning of the word says, “sender” of messages.)&lt;/p&gt;
&lt;p&gt;There are two distinct &lt;code&gt;Dispatch&lt;/code&gt; and &lt;code&gt;Dispatcher&lt;/code&gt; traits in akka. The &lt;code&gt;Dispatch&lt;/code&gt; trait has a reference to &lt;code&gt;dispatch: Dispatcher&lt;/code&gt; and &lt;code&gt;Dispatcher&lt;/code&gt;’s &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Dispatcher.scala#L52L56&quot;&gt;dispatch&lt;/a&gt; method is as follows:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; dispatch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  receiver&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ActorCell&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  invocation&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Envelope
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; mbox &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; receiver&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mailbox
  mbox&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;enqueue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;receiver&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; invocation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  registerForExecution&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mbox&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/dispatcher-ed3db186b54b5f43bbc7ddf384206e5e-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB3VcISwWf/8QAGxAAAgEFAAAAAAAAAAAAAAAAARECAAMQEiH/2gAIAQEAAQUCJpuFvYxXVj//xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAwEBPwFH/8QAFREBAQAAAAAAAAAAAAAAAAAAAAH/2gAIAQIBAT8BV//EABkQAAIDAQAAAAAAAAAAAAAAAAAhASAiMf/aAAgBAQAGPwITk12n/8QAGhAAAwADAQAAAAAAAAAAAAAAAAERECExQf/aAAgBAQABPyGS10trI9qyiNvRIuLH/9oADAMBAAIAAwAAABAzD//EABcRAQEBAQAAAAAAAAAAAAAAAAERACH/2gAIAQMBAT8QemEJd//EABcRAQEBAQAAAAAAAAAAAAAAAAERACH/2gAIAQIBAT8QOOVbN//EABwQAQEAAgIDAAAAAAAAAAAAAAERACExQRBhcf/aAAgBAQABPxC4INNvGMTiITtMsHQFUU+Yoo4Sji1AfXfj/9k=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;dispatcher&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/dispatcher-ed3db186b54b5f43bbc7ddf384206e5e-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/dispatcher-ed3db186b54b5f43bbc7ddf384206e5e-e8976.jpg 148w,
/blog/static/dispatcher-ed3db186b54b5f43bbc7ddf384206e5e-63df2.jpg 295w,
/blog/static/dispatcher-ed3db186b54b5f43bbc7ddf384206e5e-f8fb9.jpg 590w,
/blog/static/dispatcher-ed3db186b54b5f43bbc7ddf384206e5e-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Mailbox.scala#L85&quot;&gt;&lt;code&gt;Mailbox&lt;/code&gt;&lt;/a&gt; has the following &lt;code&gt;enqueue&lt;/code&gt; method&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; enqueue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;receiver&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ActorRef&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Envelope&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; messageQueue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;enqueue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;receiver&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/enqueue-9a6b0df6f94bee8c851810e8e5a0d95a-db559.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAECAwQF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAe4nIpNBZ//EABoQAAICAwAAAAAAAAAAAAAAAAERAAIDEBL/2gAIAQEAAQUCJjdMfRqBFr//xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAwEBPwFH/8QAFREBAQAAAAAAAAAAAAAAAAAAAAH/2gAIAQIBAT8BV//EABkQAAIDAQAAAAAAAAAAAAAAAAAhASAiMf/aAAgBAQAGPwITk12n/8QAGRABAQEBAQEAAAAAAAAAAAAAAREAIRAx/9oACAEBAAE/IUnEutXR2mVj64B8PP/aAAwDAQACAAMAAAAQEw//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAh/9oACAEDAQE/EHphCXf/xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAh/9oACAECAQE/EDjlWzf/xAAbEAEBAQACAwAAAAAAAAAAAAABEQAQQTFhcf/aAAgBAQABPxASAQJTMTiITtNYOgKop8wUBvi1uWoD674//9k=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;enqueue&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/enqueue-9a6b0df6f94bee8c851810e8e5a0d95a-f8fb9.jpg&quot;
        srcset=&quot;/blog/static/enqueue-9a6b0df6f94bee8c851810e8e5a0d95a-e8976.jpg 148w,
/blog/static/enqueue-9a6b0df6f94bee8c851810e8e5a0d95a-63df2.jpg 295w,
/blog/static/enqueue-9a6b0df6f94bee8c851810e8e5a0d95a-f8fb9.jpg 590w,
/blog/static/enqueue-9a6b0df6f94bee8c851810e8e5a0d95a-db559.jpg 640w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;The &lt;code&gt;messageQueue&lt;/code&gt; is type of &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Mailbox.scala#L614L618&quot;&gt;&lt;code&gt;MessageQueue&lt;/code&gt;&lt;/a&gt; class which is defined for &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/mailboxes.html?language=scala#mailboxes&quot;&gt;each different &lt;code&gt;Mailbox&lt;/code&gt; type&lt;/a&gt;. The one for the default &lt;code&gt;UnboundedMailbox&lt;/code&gt; is:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;object&lt;/span&gt; UnboundedMailbox &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; MessageQueue 
    &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; ConcurrentLinkedQueue&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Envelope&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; UnboundedQueueBasedMessageQueue &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; queue&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Queue&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Envelope&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Coming back to the &lt;code&gt;dispatch&lt;/code&gt; method of &lt;code&gt;Dispatcher&lt;/code&gt;, it has &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Dispatcher.scala#L115&quot;&gt;registerForExecution&lt;/a&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; registerForExecution&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mbox&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Mailbox&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Boolean&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
  executorService execute mbox
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Since &lt;a href=&quot;https://github.com/akka/akka/blob/v2.5.9/akka-actor/src/main/scala/akka/dispatch/Mailbox.scala#L56L57&quot;&gt;&lt;code&gt;Mailbox&lt;/code&gt;&lt;/a&gt; is defined as &lt;code&gt;ForkJoinTask&lt;/code&gt;, the execution (i.e. processing) of &lt;code&gt;Mailbox&lt;/code&gt; is run on a different &lt;code&gt;Thread&lt;/code&gt;, which will be covered in &lt;a href=&quot;../local-minimal-receiver&quot;&gt;the next article&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; Mailbox&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; messageQueue&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; MessageQueue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; ForkJoinTask&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;Unit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
  &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; SystemMessageQueue 
  &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; Runnable &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;In the next article, &lt;a href=&quot;../local-minimal-receiver&quot;&gt;Local Actor workflow part 2 - Receiver side&lt;/a&gt;, I will discuss about what happens on the receiver side which is triggered as the above &lt;code&gt;ForkJoinTask&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Instruction to run the example&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; git clone https://github.com/richardimaoka/resources.git
&gt; cd resources
&gt; cd local-minimal
&gt; sbt
&gt; runMain example.Main&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;Output&lt;/h2&gt;
&lt;p&gt;Some &lt;code&gt;println&lt;/code&gt; calls are inserted in the &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/local-minimal&quot;&gt;complete example at GitHub&lt;/a&gt; to illustrate the behavior.&lt;/p&gt;
&lt;p&gt;Thread names are shown as [exampleSystem-akka.actor.default-dispatcher-3] and […-4].&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[info] Running example.Main
provider = local
[exampleSystem-akka.actor.default-dispatcher-5] sending message Hello World to Actor[akka://exampleSystem/user/receiver#-846959521]
[exampleSystem-akka.actor.default-dispatcher-5] sending message Hello Universe to Actor[akka://exampleSystem/user/receiver#-846959521]
[exampleSystem-akka.actor.default-dispatcher-2] EchoActor: received message = Hello World
[exampleSystem-akka.actor.default-dispatcher-5] sending message Hello Galaxy to Actor[akka://exampleSystem/user/receiver#-846959521]
[exampleSystem-akka.actor.default-dispatcher-2] EchoActor: received message = Hello Universe
[exampleSystem-akka.actor.default-dispatcher-2] EchoActor: received message = Hello Galaxy
[success] Total time: 7 s, completed Jan 30, 2018 6:16:46 AM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Official documentation of Akka Actor at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/actors.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/actors.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Official documentation of Akka Dispatcher at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/dispatchers.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/dispatchers.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Official documentation of Akka lifecycle at &lt;a href=&quot;https://doc.akka.io/docs/akka/current/actors.html$actor-lifecycle&quot;&gt;https://doc.akka.io/docs/akka/current/actors.html$actor-lifecycle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Official documentation of Akka Mailbox at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/mailboxes.html?language=scala#mailboxes&quot;&gt;https://doc.akka.io/docs/akka/2.5/mailboxes.html?language=scala#mailboxes&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Official documentation of Akka location transparency at &lt;a href=&quot;https://doc.akka.io/docs/akka/current/general/remoting.html#location-transparency&quot;&gt;https://doc.akka.io/docs/akka/current/general/remoting.html#location-transparency&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Oracle’s documentation about Fork/Join at &lt;a href=&quot;https://docs.oracle.com/javase/tutorial/essential/concurrency/forkjoin.html&quot;&gt;https://docs.oracle.com/javase/tutorial/essential/concurrency/forkjoin.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ExecutorService Javadoc at &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html&quot;&gt;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Serializer minimal example]]></title><description><![CDATA[Overview You can find the code and instruction to run the example at  GitHub . Akka Serialization Akka doc’s  serialization section  says…]]></description><link>https://richardimaoka.github.io/blog//serializer-minimal/</link><guid isPermaLink="false">https://richardimaoka.github.io/blog//serializer-minimal/</guid><pubDate>Mon, 22 Jan 2018 16:31:00 GMT</pubDate><content:encoded>&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;You can find the code and instruction to run the example at &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/serialize-minimal&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Akka Serialization&lt;/h3&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe &quot;=&quot;&quot; src=&quot;https://www.youtube.com/embed/paclLCSv6NA&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;p&gt;Akka doc’s &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/serialization.html&quot;&gt;serialization section&lt;/a&gt; says:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;However, messages that have to escape the JVM to reach an actor running on a different host have to undergo some form of serialization (i.e. the objects have to be converted to and from byte arrays).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This example shows a simplified version, but still the core of what Akka serialization does -
(i.e.) how &lt;code&gt;Serialization&lt;/code&gt; Akka extention class, &lt;code&gt;Serializer&lt;/code&gt;,
and the message you want to serialize/deserialize work together.&lt;/p&gt;
&lt;h3&gt;Serializer configuration&lt;/h3&gt;
&lt;p&gt;First, you need to define your serializer class, extending &lt;code&gt;Serializer&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; akka&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;serialization&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Serializer

&lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; MyMessage&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;str1&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; str2&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; MySerializer &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; Serializer &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Then you need configuration which binds your &lt;code&gt;MySerializer&lt;/code&gt; to the &lt;code&gt;MyMessage&lt;/code&gt; type.
Note the common &lt;code&gt;mymessage&lt;/code&gt; key which defines the binding.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;&lt;span class=&quot;token comment&quot;&gt;//application.conf&lt;/span&gt;
akka &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  actor &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    serializers &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      mymessage &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;example.MySerializer&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;                                     
    serialization&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;bindings &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;              
      &lt;span class=&quot;token string&quot;&gt;&quot;example.MyMessage&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mymessage     
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Next, you should define &lt;code&gt;toBinary&lt;/code&gt; and &lt;code&gt;fromBinary&lt;/code&gt; inside &lt;code&gt;MySerializer&lt;/code&gt; to handle
serialization and deserialization of &lt;code&gt;MyMessage&lt;/code&gt; instances.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; toBinary&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;AnyRef&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Array&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;Byte&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    obj &lt;span class=&quot;token keyword&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; msg&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; MyMessage &lt;span class=&quot;token keyword&quot;&gt;=&gt;&lt;/span&gt; 
        &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;msg&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;str1 &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;|&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; msg&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;str2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;getBytes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;StandardCharsets&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;UTF_8&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; fromBinary&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bytes&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Array&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;Byte&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clazz&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Option&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Class&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;_&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;AnyRef&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; repString &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bytes&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; StandardCharsets&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;UTF_8&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// &apos;|&apos; is enclosed in single quotes = Char, not &lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; arr&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Array&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; repString&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;|&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; MyMessage&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;arr&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; arr&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;The below piece of code is the simplied version of what Akka does, when serializing a message.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;val system = akka.actor.ActorSystem(&quot;example&quot;, ConfigFactory.load())
val original = MyMessage(&quot;aaa&quot;, &quot;bbb&quot;)
val serialization = SerializationExtension(system)

//serialization by toBinary
val bytes = serializer.toBinary(original)

//de-serialization by fromBinary
val restored = serializer.fromBinary(bytes, manifest = None)&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;When you are (e.g.) sending a message to a remote JVM, this is done under the ground
and you don’t explicitly call &lt;code&gt;SerializationExtension(system)&lt;/code&gt;, &lt;code&gt;toBinary&lt;/code&gt; and &lt;code&gt;fromBinary&lt;/code&gt; yourself, but this example is to show what’s done by Akka in the simple form.&lt;/p&gt;
&lt;h2&gt;Instruction to run the example&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; git clone https://github.com/richardimaoka/resources.git
&gt; cd resources
&gt; cd serialize-minimal
&gt; sbt
&gt; runMain example.Main&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;Output&lt;/h2&gt;
&lt;p&gt;Some &lt;code&gt;println&lt;/code&gt; calls are inserted in the &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/serialize-minimal&quot;&gt;complete example at GitHub&lt;/a&gt; to illustrate the behavior&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[info] Running example.Main
Serializer for class example.MyMessage = example.MySerializer@254b2a65
MySerializer: toBinary(MyMessage(aaa,bbb)) is called
MySerializer: fromBinary(979797124989898) is called
original = MyMessage(aaa,bbb), class = class example.MyMessage
restored = MyMessage(aaa,bbb), class = class example.MyMessage
[success] Total time: 1 s, completed Jan 23, 2018 9:48:55 PM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Official documentation of Akka serialization at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/serialization.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/serialization.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[PersistentActor minimal example with akka-persistence-sql-async]]></title><description><![CDATA[Overview You can find the code and instruction to run the example at  GitHub .
There is also an  official sample  available. Refer to…]]></description><link>https://richardimaoka.github.io/blog//persistent-actor-minimal-sql/</link><guid isPermaLink="false">https://richardimaoka.github.io/blog//persistent-actor-minimal-sql/</guid><pubDate>Wed, 17 Jan 2018 16:31:00 GMT</pubDate><content:encoded>&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;You can find the code and instruction to run the example at &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/persistent-actor-minimal-sql&quot;&gt;GitHub&lt;/a&gt;.
There is also an &lt;a href=&quot;https://github.com/okumin/akka-persistence-sql-async/tree/master/sample/src/main&quot;&gt;official sample&lt;/a&gt; available.&lt;/p&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe src=&quot;https://www.youtube.com/embed/WcpEMcnx5XU&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/sql-261553d2948cdc8dfb9ce07f93dbbd86-287be.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 16.083916083916083%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAt0lEQVQI10WPy2rDMBBF8/9/lDYtZJPYYBqoHpYt7YotJUY2rV1cQ+BEVRddnRnucJi7G4aBaZoYx5EYI5P3dMbwURtCUdCdToSyxBcl/fmcWHBN++35wPXlFb9/wh+PzOnuHgK7dV3Zto1l+c786nuC1jjnMHWNlBJjGqTSvAuJTpm1NufOupyZ9ECMIz9N8y+c5yXzs+sISmFbi04UQmCaP2FVVYmKOgls26LSrKTg8nbJ7X6FD4891954O8n4AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;sql&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/sql-261553d2948cdc8dfb9ce07f93dbbd86-fb8a0.png&quot;
        srcset=&quot;/blog/static/sql-261553d2948cdc8dfb9ce07f93dbbd86-1a291.png 148w,
/blog/static/sql-261553d2948cdc8dfb9ce07f93dbbd86-2bc4a.png 295w,
/blog/static/sql-261553d2948cdc8dfb9ce07f93dbbd86-fb8a0.png 590w,
/blog/static/sql-261553d2948cdc8dfb9ce07f93dbbd86-287be.png 715w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Refer to another post, &lt;a href=&quot;../persistent-actor-minimal&quot;&gt;Persistence Actor Minimal example&lt;/a&gt; for basics of PersistentActor.&lt;/p&gt;
&lt;p&gt;In this example, the target DB is MySQL. Firstly you need to create a database &lt;code&gt;akka_persistence_sql_async&lt;/code&gt; and execute &lt;a href=&quot;https://github.com/richardimaoka/resources/blob/master/persistent-actor-minimal-sql/mysql.sql&quot;&gt;&lt;code&gt;mysql.sql&lt;/code&gt;&lt;/a&gt; so that the database has necessary tables.&lt;/p&gt;
&lt;p&gt;In &lt;a href=&quot;https://github.com/richardimaoka/resources/blob/master/persistent-actor-minimal-sql/src/main/scala/example/Main.scala#L28L38&quot;&gt;MyPersistentAcdtor&lt;/a&gt;, when &lt;code&gt;persist&lt;/code&gt; method is called, an &lt;code&gt;Event&lt;/code&gt; is sent to &lt;a href=&quot;https://github.com/okumin/akka-persistence-sql-async/blob/8dba8158273dbf206ce4abca0725e28207b1db1b/core/src/main/scala/akka/persistence/journal/sqlasync/ScalikeJDBCWriteJournal.scala&quot;&gt;ScalikeJDBCWriteJournal&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;   &lt;span class=&quot;token keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; receiveCommand&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Receive &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; Command&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; ⇒
      persist&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; 
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Then &lt;a href=&quot;https://github.com/okumin/akka-persistence-sql-async/blob/8dba8158273dbf206ce4abca0725e28207b1db1b/core/src/main/scala/akka/persistence/journal/sqlasync/ScalikeJDBCWriteJournal.scala&quot;&gt;ScalikeJDBCWriteJournal&lt;/a&gt; serializes &lt;code&gt;Event&lt;/code&gt; to &lt;code&gt;Array[Byte]&lt;/code&gt; with &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/serialization.html&quot;&gt;Akka serializer&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;After that, &lt;code&gt;ScalikeJDBCWriteJournal&lt;/code&gt; prepares an SQL statement to persist the data to an SQL database, including the &lt;code&gt;message&lt;/code&gt; column to hold the binary of &lt;code&gt;Event&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Instruction to run the example&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; git clone https://github.com/richardimaoka/resources.git
&gt; cd resources
&gt; cd persistent-actor-minimal-sql
&gt; sbt
&gt; runMain example.Main&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;Output&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[info] Running example.Main
receiveCommand  : Received Command Command(1)
persist callback: Event = Event(1) persisted
persist callback: current state = 1
receiveCommand  : Received Command Command(2)
persist callback: Event = Event(2) persisted
persist callback: current state = 3
receiveCommand  : Received Command Command(3)
persist callback: Event = Event(3) persisted
persist callback: current state = 6
[ERROR] [01/13/2018 17:24:19.422] [exampleSystem-akka.actor.default-dispatcher-7] [akka://exampleSystem/user/p1] exploded!
java.lang.Exception: exploded!
        at example.MyPersistentActor$$anonfun$receiveCommand$1.applyOrElse(Main.scala:37)
        at akka.actor.Actor.aroundReceive(Actor.scala:517)
        at akka.actor.Actor.aroundReceive$(Actor.scala:515)
        at example.MyPersistentActor.akka$persistence$Eventsourced$$super$aroundReceive(Main.scala:11)
        at akka.persistence.Eventsourced$$anon$1.stateReceive(Eventsourced.scala:663)
        at akka.persistence.Eventsourced.aroundReceive(Eventsourced.scala:183)
        at akka.persistence.Eventsourced.aroundReceive$(Eventsourced.scala:182)
        at example.MyPersistentActor.aroundReceive(Main.scala:11)
        at akka.actor.ActorCell.receiveMessage(ActorCell.scala:527)
        at akka.actor.ActorCell.invoke(ActorCell.scala:496)
        at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:257)
        at akka.dispatch.Mailbox.run(Mailbox.scala:224)
        at akka.dispatch.Mailbox.exec(Mailbox.scala:234)
        at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
        at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
        at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
        at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)

receiveRecover  : Recovering an event = Event(1)
receiveRecover  : current state = 1
receiveRecover  : Recovering an event = Event(2)
receiveRecover  : current state = 3
receiveRecover  : Recovering an event = Event(3)
receiveRecover  : current state = 6
receiveCommand  : Received Command Command(4)
persist callback: Event = Event(4) persisted
persist callback: current state = 10
receiveCommand  : Received Command Command(5)
persist callback: Event = Event(5) persisted
persist callback: current state = 15
[success] Total time: 2 s, completed Jan 13, 2018 5:24:20 PM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Official persistence documentation at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/persistence.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/persistence.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Official Akka serialization documentation at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/serialization.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/serialization.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;akka-persistence-sql-async plugin at &lt;a href=&quot;https://github.com/okumin/akka-persistence-sql-async&quot;&gt;https://github.com/okumin/akka-persistence-sql-async&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Event Adapter with akka-persistence-cassandra]]></title><description><![CDATA[Overview You can find the code and instruction to run the example at  GitHub . You firstly need  configuration  to tie up  MyEventAdapter…]]></description><link>https://richardimaoka.github.io/blog//event-adapter-cassandra/</link><guid isPermaLink="false">https://richardimaoka.github.io/blog//event-adapter-cassandra/</guid><pubDate>Tue, 16 Jan 2018 16:31:00 GMT</pubDate><content:encoded>&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;You can find the code and instruction to run the example at &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/event-adapter-tagging-cassandra&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe src=&quot;https://www.youtube.com/embed/cIau92KiNiE&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/cqlsh-43c57ec5e10939f5112d19aa98ca4a50-fcf37.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 24.324324324324326%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAA+ElEQVQY03WP6UuEUBTFrzDquMxooONCgeuoUDQtRBRURAv9/+SoH9T/5Mx7F6IF+nC45573zu/x6HO/R9d1GPoewzBgHEdM0/RL8zxzLs/l3Z/qRW8vGG3bssj3fbiuiyAIeG42G9i2DV3XYZomHMfBer3mzDAMKIoCIvpflmUxTFVVaJoGz/N4l2A5wzBEkiSoqgrb7ZaV5zmKomCfZRn7NE1R1zVotbK5KF82lgvhfURRxJKwOI658AWUsyxLLv/1TdOAPG+BlydCHBKOXMJySQL+/YWTY8LdLeHxnnB9QTg/Jbw9Ez5eCQ8iu7ki7M4IlzvCu8gPmNKsjS+tLm8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;cqlsh&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/cqlsh-43c57ec5e10939f5112d19aa98ca4a50-fb8a0.png&quot;
        srcset=&quot;/blog/static/cqlsh-43c57ec5e10939f5112d19aa98ca4a50-1a291.png 148w,
/blog/static/cqlsh-43c57ec5e10939f5112d19aa98ca4a50-2bc4a.png 295w,
/blog/static/cqlsh-43c57ec5e10939f5112d19aa98ca4a50-fb8a0.png 590w,
/blog/static/cqlsh-43c57ec5e10939f5112d19aa98ca4a50-fcf37.png 740w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;You firstly need &lt;a href=&quot;https://github.com/richardimaoka/resources/blob/master/event-adapter-tagging-cassandra/src/main/resources/application.conf#L26L33&quot;&gt;configuration&lt;/a&gt; to tie up &lt;code&gt;MyEventAdapter&lt;/code&gt; under the &lt;code&gt;example&lt;/code&gt; package, and &lt;code&gt;Event&lt;/code&gt; under the same &lt;code&gt;example&lt;/code&gt; package.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;cassandra-journal {
  event-adapters {
    tagging-adapter = &quot;example.MyEventAdapter&quot;
  }
  event-adapter-bindings {
    &quot;example.Event&quot; = tagging-adapter
  }
}&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;In &lt;a href=&quot;https://github.com/richardimaoka/resources/blob/master/event-adapter-tagging-cassandra/src/main/scala/example/Main.scala#L28L38&quot;&gt;MyPersistentAcdtor&lt;/a&gt;, when &lt;code&gt;persist&lt;/code&gt; method is called, an &lt;code&gt;Event&lt;/code&gt; is sent to &lt;a href=&quot;https://github.com/akka/akka-persistence-cassandra/blob/bf6bcbfa5d5616a285872ff605430c5b18ea289c/core/src/main/scala/akka/persistence/cassandra/journal/CassandraJournal.scala#L42&quot;&gt;CassandraJournal&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;   &lt;span class=&quot;token keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; receiveCommand&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Receive &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; Command&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; ⇒
      persist&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; 
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Then &lt;a href=&quot;https://github.com/akka/akka-persistence-cassandra/blob/bf6bcbfa5d5616a285872ff605430c5b18ea289c/core/src/main/scala/akka/persistence/cassandra/journal/CassandraJournal.scala#L42&quot;&gt;CassandraJournal&lt;/a&gt; invokes the &lt;code&gt;toJournal&lt;/code&gt; method of &lt;a href=&quot;https://github.com/richardimaoka/resources/blob/master/event-adapter-tagging-cassandra/src/main/scala/example/MyEventAdapter.scala#L9&quot;&gt;MyEventAdapter.scala&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;  &lt;span class=&quot;token keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; toJournal&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Any&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;val&lt;/span&gt; tags &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Set&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;mytag1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;mytag2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    Tagged&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; tags&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;  
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;After that, &lt;code&gt;Tagged(event, tags)&lt;/code&gt; is serialized to &lt;code&gt;Array[Byte]&lt;/code&gt; &lt;/p&gt;
&lt;p&gt;In more detail, &lt;a href=&quot;https://github.com/akka/akka-persistence-cassandra/blob/bf6bcbfa5d5616a285872ff605430c5b18ea289c/core/src/main/scala/akka/persistence/cassandra/journal/CassandraJournal.scala#L42&quot;&gt;CassandraJournal&lt;/a&gt;’s &lt;a href=&quot;https://github.com/akka/akka-persistence-cassandra/blob/bf6bcbfa5d5616a285872ff605430c5b18ea289c/core/src/main/scala/akka/persistence/cassandra/journal/CassandraJournal.scala#L464&quot;&gt;&lt;code&gt;def serializeEvent()&lt;/code&gt;&lt;/a&gt; method serializes &lt;code&gt;payload&lt;/code&gt; (in this example, &lt;code&gt;Tagged(event, tags)&lt;/code&gt;) to  &lt;code&gt;Array[Byte]&lt;/code&gt; with &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/serialization.html&quot;&gt;Akka serializer&lt;/a&gt;. After that, &lt;code&gt;CassandraJournal&lt;/code&gt; prepares a CQL statement to set all necessary columns in Cassandra, including the &lt;code&gt;event&lt;/code&gt; column to hold the binary of &lt;code&gt;Tagged(event, tags)&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Instruction to run the example&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; git clone https://github.com/richardimaoka/resources.git
&gt; cd resources
&gt; cd event-adapter-tagging-cassandra
&gt; sbt
&gt; runMain example.Main&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;Output&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; runMain example.Main
[info] Running example.Main
receiveCommand  : Received Command(1)
EventAdapter    : toJournal called for event = Event(1), tags = Set(mytag1, mytag2)
[WARN] [SECURITY][01/17/2018 05:59:44.106] [exampleSystem-cassandra-plugin-default-dispatcher-8] [akka.serialization.Serialization(akka://exampleSystem)] Using the default Java serializer for class [example.Event] which is not recommended because of performance implications. Use another serializer or disable this warning using the setting &apos;akka.actor.warn-about-java-serializer-usage&apos;
persist callback: Event = Event(1) persisted
persist callback: current state = 1
receiveCommand  : Received Command(2)
EventAdapter    : toJournal called for event = Event(2), tags = Set(mytag1, mytag2)
persist callback: Event = Event(2) persisted
persist callback: current state = 3
receiveCommand  : Received Command(3)
EventAdapter    : toJournal called for event = Event(3), tags = Set(mytag1, mytag2)
persist callback: Event = Event(3) persisted
persist callback: current state = 6
[ERROR] [01/17/2018 05:59:45.538] [exampleSystem-akka.actor.default-dispatcher-12] [akka://exampleSystem/user/p1] exploded!
java.lang.Exception: exploded!
        at example.MyPersistentActor$$anonfun$receiveCommand$1.applyOrElse(Main.scala:37)
        at akka.actor.Actor.aroundReceive(Actor.scala:517)
        at akka.actor.Actor.aroundReceive$(Actor.scala:515)
        at example.MyPersistentActor.akka$persistence$Eventsourced$$super$aroundReceive(Main.scala:11)
        at akka.persistence.Eventsourced$$anon$1.stateReceive(Eventsourced.scala:680)
        at akka.persistence.Eventsourced.aroundReceive(Eventsourced.scala:192)
        at akka.persistence.Eventsourced.aroundReceive$(Eventsourced.scala:191)
        at example.MyPersistentActor.aroundReceive(Main.scala:11)
        at akka.actor.ActorCell.receiveMessage(ActorCell.scala:527)
        at akka.actor.ActorCell.invoke(ActorCell.scala:496)
        at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:257)
        at akka.dispatch.Mailbox.run(Mailbox.scala:224)
        at akka.dispatch.Mailbox.exec(Mailbox.scala:234)
        at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
        at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
        at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
        at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)

EventAdapter    : fromJournal called for event = Event(1) and manifest =
EventAdapter    : fromJournal called for event = Event(2) and manifest =
EventAdapter    : fromJournal called for event = Event(3) and manifest =
receiveRecover  : Recovering an event = Event(1)
receiveRecover  : current state = 1
receiveRecover  : Recovering an event = Event(2)
receiveRecover  : current state = 3
receiveRecover  : Recovering an event = Event(3)
receiveRecover  : current state = 6
receiveCommand  : Received Command(4)
EventAdapter    : toJournal called for event = Event(4), tags = Set(mytag1, mytag2)
persist callback: Event = Event(4) persisted
persist callback: current state = 10
receiveCommand  : Received Command(5)
EventAdapter    : toJournal called for event = Event(5), tags = Set(mytag1, mytag2)
persist callback: Event = Event(5) persisted
persist callback: current state = 15
[success] Total time: 12 s, completed Jan 17, 2018 5:59:52 AM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Official persistence documentation at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/persistence.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/persistence.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Official event adapter documentation for tagging at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/persistence.html#event-adapters&quot;&gt;https://doc.akka.io/docs/akka/2.5/persistence.html#event-adapters&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Official Akka serialization documentation at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5/serialization.html&quot;&gt;https://doc.akka.io/docs/akka/2.5/serialization.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;akka-persistence-cassandra at &lt;a href=&quot;https://github.com/akka/akka-persistence-cassandra&quot;&gt;https://github.com/akka/akka-persistence-cassandra&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Apache Cassandra downloading page at &lt;a href=&quot;http://cassandra.apache.org/download/&quot;&gt;http://cassandra.apache.org/download/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Datastax provides a great deal of documentation about Cassandra, including a free course avaialble as of the time of this blog post &lt;a href=&quot;https://academy.datastax.com/courses&quot;&gt;https://academy.datastax.com/courses&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[PersistentActor minimal example]]></title><description><![CDATA[Overview You can find the code and instruction to run the example at  GitHub . receiveCommand Persistence actor receives a  Command  and…]]></description><link>https://richardimaoka.github.io/blog//persistent-actor-minimal/</link><guid isPermaLink="false">https://richardimaoka.github.io/blog//persistent-actor-minimal/</guid><pubDate>Sat, 13 Jan 2018 16:31:00 GMT</pubDate><content:encoded>&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;You can find the code and instruction to run the example at &lt;a href=&quot;https://github.com/richardimaoka/resources/tree/master/persistent-actor-minimal&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;receiveCommand&lt;/h3&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe &quot;=&quot;&quot; src=&quot;https://www.youtube.com/embed/Jt9xDvYMNMc&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;  &lt;span class=&quot;token keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; receiveCommand&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Receive &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; Command&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; ⇒
      persist&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; event ⇒
        sum &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; i
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Persistence actor receives a &lt;code&gt;Command&lt;/code&gt; and generate an &lt;code&gt;Event&lt;/code&gt;, then persist the &lt;code&gt;Event&lt;/code&gt; via &lt;code&gt;Journal&lt;/code&gt;. The &lt;code&gt;receiveCommand&lt;/code&gt; method of &lt;code&gt;PersistentActor&lt;/code&gt; does that.&lt;/p&gt;
&lt;h3&gt;receiveRecover&lt;/h3&gt;
&lt;div&gt;
          &lt;div
            class=&quot;gatsby-resp-iframe-wrapper&quot;
            style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem&quot;
          &gt;
            &lt;iframe src=&quot;https://www.youtube.com/embed/xfsF0u0s3e4&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen style=&quot;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          &quot;&gt;&lt;/iframe&gt;
          &lt;/div&gt;
          &lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-scala&quot;&gt;&lt;code&gt;  &lt;span class=&quot;token keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; receiveRecover&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Receive &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; Event&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; ⇒
      sum &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; i
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;&lt;code&gt;receiveRecover&lt;/code&gt; is called upon restarting a &lt;code&gt;PersistentActor&lt;/code&gt; after exception was thrown.&lt;/p&gt;
&lt;h2&gt;Instruction to run the example&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;&gt; git clone https://github.com/richardimaoka/resources.git
&gt; cd resources
&gt; cd persistent-actor-minimal
&gt; sbt
&gt; runMain example.Main&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;Output&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-none&quot;&gt;&lt;code&gt;[info] Running example.Main
receiveCommand  : Received Command Command(1)
persist callback: Event = Event(1) persisted
persist callback: current state = 1
receiveCommand  : Received Command Command(2)
persist callback: Event = Event(2) persisted
persist callback: current state = 3
receiveCommand  : Received Command Command(3)
persist callback: Event = Event(3) persisted
persist callback: current state = 6
[ERROR] [01/13/2018 17:24:19.422] [exampleSystem-akka.actor.default-dispatcher-7] [akka://exampleSystem/user/p1] exploded!
java.lang.Exception: exploded!
        at example.MyPersistentActor$$anonfun$receiveCommand$1.applyOrElse(Main.scala:37)
        at akka.actor.Actor.aroundReceive(Actor.scala:517)
        at akka.actor.Actor.aroundReceive$(Actor.scala:515)
        at example.MyPersistentActor.akka$persistence$Eventsourced$$super$aroundReceive(Main.scala:11)
        at akka.persistence.Eventsourced$$anon$1.stateReceive(Eventsourced.scala:663)
        at akka.persistence.Eventsourced.aroundReceive(Eventsourced.scala:183)
        at akka.persistence.Eventsourced.aroundReceive$(Eventsourced.scala:182)
        at example.MyPersistentActor.aroundReceive(Main.scala:11)
        at akka.actor.ActorCell.receiveMessage(ActorCell.scala:527)
        at akka.actor.ActorCell.invoke(ActorCell.scala:496)
        at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:257)
        at akka.dispatch.Mailbox.run(Mailbox.scala:224)
        at akka.dispatch.Mailbox.exec(Mailbox.scala:234)
        at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
        at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
        at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
        at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)

receiveRecover  : Recovering an event = Event(1)
receiveRecover  : current state = 1
receiveRecover  : Recovering an event = Event(2)
receiveRecover  : current state = 3
receiveRecover  : Recovering an event = Event(3)
receiveRecover  : current state = 6
receiveCommand  : Received Command Command(4)
persist callback: Event = Event(4) persisted
persist callback: current state = 10
receiveCommand  : Received Command Command(5)
persist callback: Event = Event(5) persisted
persist callback: current state = 15
[success] Total time: 2 s, completed Jan 13, 2018 5:24:20 PM&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Official documentation at &lt;a href=&quot;https://doc.akka.io/docs/akka/2.5.9/persistence.html&quot;&gt;https://doc.akka.io/docs/akka/2.5.9/persistence.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item></channel></rss>